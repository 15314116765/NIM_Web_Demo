!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.WhiteBoard=e():t.WhiteBoard=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}var o=n(99),r=i(o);n(112);var s=n(346),a=n(347),c=n(363),l=n(361),u=n(49),h=n(348),f=n(349),d=n(350),p=(0,r["default"])({},u.constantBB,{install:function(t,e){s.install(t,e),a.install(t,e),t.parser.mixin({configMap:h,serializeMap:f,unserializeMap:d})},getInstance:function(t){return new l(t)},destroy:function(t){t&&(t.destroy(),t=null)},checkCompatibility:function(){return c()}});t.exports=p},,function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var i=n(35)("wks"),o=n(22),r=n(2).Symbol,s="function"==typeof r,a=t.exports=function(t){return i[t]||(i[t]=s&&r[t]||(s?r:o)("Symbol."+t))};a.store=i},function(t,e,n){(function(e){"use strict";var n="'a8127541deb97f1499a6e47e6f8a199a894d782b",i="a812754'",o="5.0.0",r="2.6.0.328",s="3.9.0",a="46",c="1",l=1,u="https://lbs.netease.im/lbs/webconf.jsp",h="roomserver.netease.im",f="https://dr.netease.im/1.gif",d="development"===e.env.NODE_ENV?6e3:42e3,p={info:{hash:n,shortHash:i,version:o,sdkVersion:a,nrtcVersion:s,nrtcSdkVersion:c,protocolVersion:l},agentVersion:r,lbsUrl:u,roomserver:h,connectTimeout:d,xhrTimeout:d,socketTimeout:d,reconnectionDelay:656.25,reconnectionDelayMax:d,reconnectionJitter:.1,heartbeatInterval:18e4,cmdTimeout:d,defaultReportUrl:f};p.formatSocketUrl=function(t){var e=t.url,n=t.secure,i=n?"https":"http";return e.indexOf("http")===-1?i+"://"+e:e},p.uploadUrl="https://nos.netease.com",p.replaceUrl="https://{bucket}.nosdn.127.net/{object}",p.downloadHost="nos.netease.com",p.downloadUrl="https://{bucket}.nosdn.127.net/{object}",p.httpsEnabled=!1,p.genUploadUrl=function(t){return p.uploadUrl+"/"+t},p.genDownloadUrl=function(t,e){var n=p.replaceUrl;return/^http/.test(n)?p.httpsEnabled&&(n=n.replace("http","https")):n=p.httpsEnabled?"https://"+n:"http://"+n,n.replace("{bucket}",t).replace("{object}",e)},t.exports=p}).call(e,n(31))},function(t,e,n){(function(e,i){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   4.0.5
	 */
!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function o(t){return"function"==typeof t}function r(t){Q=t}function s(t){$=t}function a(){return function(){return e.nextTick(f)}}function c(){return"undefined"!=typeof J?function(){J(f)}:h()}function l(){var t=0,e=new Z(f),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function u(){var t=new MessageChannel;return t.port1.onmessage=f,function(){return t.port2.postMessage(0)}}function h(){var t=setTimeout;return function(){return t(f,1)}}function f(){for(var t=0;t<G;t+=2){var e=nt[t],n=nt[t+1];e(n),nt[t]=void 0,nt[t+1]=void 0}G=0}function d(){try{var t=n(96);return J=t.runOnLoop||t.runOnContext,c()}catch(e){return h()}}function p(t,e){var n=arguments,i=this,o=new this.constructor(b);void 0===o[ot]&&j(o);var r=i._state;return r?!function(){var t=n[r-1];$(function(){return P(r,o,t,i._result)})}():A(i,o,t,e),o}function v(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(b);return S(n,t),n}function b(){}function y(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function m(t){try{return t.then}catch(e){return ct.error=e,ct}}function _(t,e,n,i){try{t.call(e,n,i)}catch(o){return o}}function w(t,e,n){$(function(t){var i=!1,o=_(n,e,function(n){i||(i=!0,e!==n?S(t,n):T(t,n))},function(e){i||(i=!0,x(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&o&&(i=!0,x(t,o))},t)}function C(t,e){e._state===st?T(t,e._result):e._state===at?x(t,e._result):A(e,void 0,function(e){return S(t,e)},function(e){return x(t,e)})}function O(t,e,n){e.constructor===t.constructor&&n===p&&e.constructor.resolve===v?C(t,e):n===ct?x(t,ct.error):void 0===n?T(t,e):o(n)?w(t,e,n):T(t,e)}function S(e,n){e===n?x(e,y()):t(n)?O(e,n,m(n)):T(e,n)}function I(t){t._onerror&&t._onerror(t._result),E(t)}function T(t,e){t._state===rt&&(t._result=e,t._state=st,0!==t._subscribers.length&&$(E,t))}function x(t,e){t._state===rt&&(t._state=at,t._result=e,$(I,t))}function A(t,e,n,i){var o=t._subscribers,r=o.length;t._onerror=null,o[r]=e,o[r+st]=n,o[r+at]=i,0===r&&t._state&&$(E,t)}function E(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,o=void 0,r=t._result,s=0;s<e.length;s+=3)i=e[s],o=e[s+n],i?P(n,i,o,r):o(r);t._subscribers.length=0}}function M(){this.error=null}function D(t,e){try{return t(e)}catch(n){return lt.error=n,lt}}function P(t,e,n,i){var r=o(n),s=void 0,a=void 0,c=void 0,l=void 0;if(r){if(s=D(n,i),s===lt?(l=!0,a=s.error,s=null):c=!0,e===s)return void x(e,g())}else s=i,c=!0;e._state!==rt||(r&&c?S(e,s):l?x(e,a):t===st?T(e,s):t===at&&x(e,s))}function k(t,e){try{e(function(e){S(t,e)},function(e){x(t,e)})}catch(n){x(t,n)}}function N(){return ut++}function j(t){t[ot]=ut++,t._state=void 0,t._result=void 0,t._subscribers=[]}function L(t,e){this._instanceConstructor=t,this.promise=new t(b),this.promise[ot]||j(this.promise),K(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&T(this.promise,this._result))):x(this.promise,U())}function U(){return new Error("Array Methods must be provided an Array")}function R(t){return new L(this,t).promise}function W(t){var e=this;return new e(K(t)?function(n,i){for(var o=t.length,r=0;r<o;r++)e.resolve(t[r]).then(n,i)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function B(t){var e=this,n=new e(b);return x(n,t),n}function F(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Y(t){this[ot]=N(),this._result=this._state=void 0,this._subscribers=[],b!==t&&("function"!=typeof t&&F(),this instanceof Y?k(this,t):H())}function V(){var t=void 0;if("undefined"!=typeof i)t=i;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var o=null;try{o=Object.prototype.toString.call(n.resolve())}catch(e){}if("[object Promise]"===o&&!n.cast)return}t.Promise=Y}var z=void 0;z=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var K=z,G=0,J=void 0,Q=void 0,$=function(t,e){nt[G]=t,nt[G+1]=e,G+=2,2===G&&(Q?Q(f):it())},X="undefined"!=typeof window?window:void 0,q=X||{},Z=q.MutationObserver||q.WebKitMutationObserver,tt="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),et="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,nt=new Array(1e3),it=void 0;it=tt?a():Z?l():et?u():void 0===X?d():h();var ot=Math.random().toString(36).substring(16),rt=void 0,st=1,at=2,ct=new M,lt=new M,ut=0;return L.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===rt&&n<t;n++)this._eachEntry(e[n],n)},L.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===v){var o=m(t);if(o===p&&t._state!==rt)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===Y){var r=new n(b);O(r,t,o),this._willSettleAt(r,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(i(t),e)},L.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===rt&&(this._remaining--,t===at?x(i,n):this._result[e]=n),0===this._remaining&&T(i,this._result)},L.prototype._willSettleAt=function(t,e){var n=this;A(t,void 0,function(t){return n._settledAt(st,e,t)},function(t){return n._settledAt(at,e,t)})},Y.all=R,Y.race=W,Y.resolve=v,Y.reject=B,Y._setScheduler=r,Y._setAsap=s,Y._asap=$,Y.prototype={constructor:Y,then:p,"catch":function(t){return this.then(null,t)}},Y.polyfill=V,Y.Promise=Y,Y})}).call(e,n(31),function(){return this}())},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e){"use strict";e.__esModule=!0,e["default"]=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){t.exports=!n(19)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(10),o=n(21);t.exports=n(8)?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(14),o=n(51),r=n(37),s=Object.defineProperty;e.f=n(8)?Object.defineProperty:function(t,e,n){if(i(t),e=r(e,!0),i(n),o)try{return s(t,e,n)}catch(a){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e){var n=t.exports={version:"2.5.3"};"number"==typeof __e&&(__e=n)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var i=n(58),o=n(32);t.exports=function(t){return i(o(t))}},function(t,e,n){var i=n(12);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(76),r=i(o),s=n(75),a=i(s),c="function"==typeof a["default"]&&"symbol"==typeof r["default"]?function(t){return typeof t}:function(t){return t&&"function"==typeof a["default"]&&t.constructor===a["default"]&&t!==a["default"].prototype?"symbol":typeof t};e["default"]="function"==typeof a["default"]&&"symbol"===c(r["default"])?function(t){return"undefined"==typeof t?"undefined":c(t)}:function(t){return t&&"function"==typeof a["default"]&&t.constructor===a["default"]&&t!==a["default"].prototype?"symbol":"undefined"==typeof t?"undefined":c(t)}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(122),r=i(o),s=n(121),a=i(s),c=n(15),l=i(c);e["default"]=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":(0,l["default"])(e)));t.prototype=(0,a["default"])(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(r["default"]?(0,r["default"])(t,e):t.__proto__=e)}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(15),r=i(o);e["default"]=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"==typeof e?"undefined":(0,r["default"])(e))&&"function"!=typeof e?t:e}},function(t,e,n){var i=n(2),o=n(11),r=n(45),s=n(9),a="prototype",c=function(t,e,n){var l,u,h,f=t&c.F,d=t&c.G,p=t&c.S,v=t&c.P,b=t&c.B,y=t&c.W,g=d?o:o[e]||(o[e]={}),m=g[a],_=d?i:p?i[e]:(i[e]||{})[a];d&&(n=e);for(l in n)u=!f&&_&&void 0!==_[l],u&&l in g||(h=u?_[l]:n[l],g[l]=d&&"function"!=typeof _[l]?n[l]:b&&u?r(h,i):y&&_[l]==h?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e[a]=t[a],e}(h):v&&"function"==typeof h?r(Function.call,h):h,v&&((g.virtual||(g.virtual={}))[l]=h,t&c.R&&m&&!m[l]&&s(m,l,h)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e,n){"use strict";function i(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(){this._events=new i,this._eventsCount=0}var s=Object.prototype.hasOwnProperty,a="~";Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(a=!1)),r.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)s.call(t,e)&&n.push(a?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},r.prototype.listeners=function(t,e){var n=a?a+t:t,i=this._events[n];if(e)return!!i;if(!i)return[];if(i.fn)return[i.fn];for(var o=0,r=i.length,s=new Array(r);o<r;o++)s[o]=i[o].fn;return s},r.prototype.emit=function(t,e,n,i,o,r){var s=a?a+t:t;if(!this._events[s])return!1;var c,l,u=this._events[s],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,n),!0;case 4:return u.fn.call(u.context,e,n,i),!0;case 5:return u.fn.call(u.context,e,n,i,o),!0;case 6:return u.fn.call(u.context,e,n,i,o,r),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var f,d=u.length;for(l=0;l<d;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,n);break;case 4:u[l].fn.call(u[l].context,e,n,i);break;default:if(!c)for(f=1,c=new Array(h-1);f<h;f++)c[f-1]=arguments[f];u[l].fn.apply(u[l].context,c)}}return!0},r.prototype.on=function(t,e,n){var i=new o(e,n||this),r=a?a+t:t;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},r.prototype.once=function(t,e,n){var i=new o(e,n||this,!0),r=a?a+t:t;return this._events[r]?this._events[r].fn?this._events[r]=[this._events[r],i]:this._events[r].push(i):(this._events[r]=i,this._eventsCount++),this},r.prototype.removeListener=function(t,e,n,o){var r=a?a+t:t;if(!this._events[r])return this;if(!e)return 0===--this._eventsCount?this._events=new i:delete this._events[r],this;var s=this._events[r];if(s.fn)s.fn!==e||o&&!s.once||n&&s.context!==n||(0===--this._eventsCount?this._events=new i:delete this._events[r]);else{for(var c=0,l=[],u=s.length;c<u;c++)(s[c].fn!==e||o&&!s[c].once||n&&s[c].context!==n)&&l.push(s[c]);l.length?this._events[r]=1===l.length?l[0]:l:0===--this._eventsCount?this._events=new i:delete this._events[r]}return this},r.prototype.removeAllListeners=function(t){var e;return t?(e=a?a+t:t,this._events[e]&&(0===--this._eventsCount?this._events=new i:delete this._events[e])):(this._events=new i,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=a,r.EventEmitter=r,t.exports=r},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},,function(t,e,n){var i=n(54),o=n(33);t.exports=Object.keys||function(t){return i(t,o)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e){t.exports={}},,,function(t,e){t.exports=!0},function(t,e,n){var i=n(10).f,o=n(6),r=n(3)("toStringTag");t.exports=function(t,e,n){t&&!o(t=n?t:t.prototype,r)&&i(t,r,{configurable:!0,value:e})}},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(u===setTimeout)return setTimeout(t,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function r(t){if(h===clearTimeout)return clearTimeout(t);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){v&&d&&(v=!1,d.length?p=d.concat(p):b=-1,p.length&&a())}function a(){if(!v){var t=o(s);v=!0;for(var e=p.length;e;){for(d=p,p=[];++b<e;)d&&d[b].run();b=-1,e=p.length}d=null,v=!1,r(t)}}function c(t,e){this.fun=t,this.array=e}function l(){}var u,h,f=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(t){u=n}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(t){h=i}}();var d,p=[],v=!1,b=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new c(t,e)),1!==p.length||v||o(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var i=n(35)("keys"),o=n(22);t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,e,n){var i=n(2),o="__core-js_shared__",r=i[o]||(i[o]={});t.exports=function(t){return r[t]||(r[t]={})}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(12);t.exports=function(t,e){if(!i(t))return t;var n,o;if(e&&"function"==typeof(n=t.toString)&&!i(o=n.call(t)))return o;if("function"==typeof(n=t.valueOf)&&!i(o=n.call(t)))return o;if(!e&&"function"==typeof(n=t.toString)&&!i(o=n.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(2),o=n(11),r=n(29),s=n(39),a=n(10).f;t.exports=function(t){var e=o.Symbol||(o.Symbol=r?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},function(t,e,n){e.f=n(3)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(109);Object.defineProperty(e,"ajax",{enumerable:!0,get:function(){return i(o)["default"]}});var r=n(118);Object.defineProperty(e,"element",{enumerable:!0,get:function(){return i(r)["default"]}});var s=n(110);Object.defineProperty(e,"tool",{enumerable:!0,get:function(){return i(s)["default"]}})},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(14),o=n(86),r=n(33),s=n(34)("IE_PROTO"),a=function(){},c="prototype",l=function(){var t,e=n(47)("iframe"),i=r.length,o="<",s=">";for(e.style.display="none",n(68).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(o+"script"+s+"document.F=Object"+o+"/script"+s),t.close(),l=t.F;i--;)delete l[c][r[i]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(a[c]=i(t),n=new a,a[c]=null,n[s]=t):n=l(),void 0===e?n:o(n,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},,function(t,e,n){var i=n(56);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var i;(function(t,o){(function(){"use strict";function r(t){return t=String(t),t.charAt(0).toUpperCase()+t.slice(1)}function s(t,e,n){var i={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return e&&n&&/^Win/i.test(t)&&!/^Windows Phone /i.test(t)&&(i=i[/[\d.]+$/.exec(t)])&&(t="Windows "+i),t=String(t),e&&n&&(t=t.replace(RegExp(e,"i"),n)),t=c(t.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function a(t,e){var n=-1,i=t?t.length:0;if("number"==typeof i&&i>-1&&i<=w)for(;++n<i;)e(t[n],n,t);else l(t,e)}function c(t){return t=p(t),/^(?:webOS|i(?:OS|P))/.test(t)?t:r(t)}function l(t,e){for(var n in t)S.call(t,n)&&e(t[n],n,t)}function u(t){return null==t?r(t):I.call(t).slice(8,-1)}function h(t,e){var n=null!=t?typeof t[e]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(n)||"object"==n&&!t[e])}function f(t){return String(t).replace(/([ -])(?!$)/g,"$1?")}function d(t,e){var n=null;return a(t,function(i,o){n=e(n,i,o,t)}),n}function p(t){return String(t).replace(/^ +| +$/g,"")}function v(t){function e(e){return d(e,function(e,n){return e||RegExp("\\b"+(n.pattern||f(n))+"\\b","i").exec(t)&&(n.label||n)})}function n(e){return d(e,function(e,n,i){return e||(n[K]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(K)]||RegExp("\\b"+f(i)+"(?:\\b|\\w*\\d)","i").exec(t))&&i})}function i(e){return d(e,function(e,n){return e||RegExp("\\b"+(n.pattern||f(n))+"\\b","i").exec(t)&&(n.label||n)})}function o(e){return d(e,function(e,n){var i=n.pattern||f(n);return!e&&(e=RegExp("\\b"+i+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=s(e,i,n.label||n)),e})}function r(e){return d(e,function(e,n){var i=n.pattern||f(n);return!e&&(e=RegExp("\\b"+i+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+i+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+i+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(i,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=c(e[0].replace(RegExp(i,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e})}function a(e){return d(e,function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null})}function b(){return this.description||""}var g=y,m=t&&"object"==typeof t&&"String"!=u(t);m&&(g=t,t=null);var _=g.navigator||{},w=_.userAgent||"";t||(t=w);var O,S,T=m?!!_.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(I.toString()),x="Object",A=m?x:"ScriptBridgingProxyObject",E=m?x:"Environment",M=m&&g.java?"JavaPackage":u(g.java),D=m?x:"RuntimeObject",P=/\bJava/.test(M)&&g.java,k=P&&u(g.environment)==E,N=P?"a":"α",j=P?"b":"β",L=g.document||{},U=g.operamini||g.opera,R=C.test(R=m&&U?U["[[Class]]"]:u(U))?R:U=null,W=t,B=[],F=null,H=t==w,Y=H&&U&&"function"==typeof U.version&&U.version(),V=e([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),z=i(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),K=r([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),G=n({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),J=o(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(V&&(V=[V]),G&&!K&&(K=r([G])),(O=/\bGoogle TV\b/.exec(K))&&(K=O[0]),/\bSimulator\b/i.test(t)&&(K=(K?K+" ":"")+"Simulator"),"Opera Mini"==z&&/\bOPiOS\b/.test(t)&&B.push("running in Turbo/Uncompressed mode"),"IE"==z&&/\blike iPhone OS\b/.test(t)?(O=v(t.replace(/like iPhone OS/,"")),G=O.manufacturer,K=O.product):/^iP/.test(K)?(z||(z="Safari"),J="iOS"+((O=/ OS ([\d_]+)/i.exec(t))?" "+O[1].replace(/_/g,"."):"")):"Konqueror"!=z||/buntu/i.test(J)?G&&"Google"!=G&&(/Chrome/.test(z)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(K))||/\bAndroid\b/.test(J)&&/^Chrome/.test(z)&&/\bVersion\//i.test(t)?(z="Android Browser",J=/\bAndroid\b/.test(J)?J:"Android"):"Silk"==z?(/\bMobi/i.test(t)||(J="Android",B.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&B.unshift("accelerated")):"PaleMoon"==z&&(O=/\bFirefox\/([\d.]+)\b/.exec(t))?B.push("identifying as Firefox "+O[1]):"Firefox"==z&&(O=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(J||(J="Firefox OS"),K||(K=O[1])):!z||(O=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(z))?(z&&!K&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(O+"/")+8))&&(z=null),(O=K||G||J)&&(K||G||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(J))&&(z=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(J)?J:O)+" Browser")):"Electron"==z&&(O=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&B.push("Chromium "+O):J="Kubuntu",Y||(Y=a(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",f(z),"(?:Firefox|Minefield|NetFront)"])),(O="iCab"==V&&parseFloat(Y)>3&&"WebKit"||/\bOpera\b/.test(z)&&(/\bOPR\b/.test(t)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(V)&&"WebKit"||!V&&/\bMSIE\b/i.test(t)&&("Mac OS"==J?"Tasman":"Trident")||"WebKit"==V&&/\bPlayStation\b(?! Vita\b)/i.test(z)&&"NetFront")&&(V=[O]),"IE"==z&&(O=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(z+=" Mobile",J="Windows Phone "+(/\+$/.test(O)?O:O+".x"),B.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(z="IE Mobile",J="Windows Phone 8.x",B.unshift("desktop mode"),Y||(Y=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=z&&"Trident"==V&&(O=/\brv:([\d.]+)/.exec(t))&&(z&&B.push("identifying as "+z+(Y?" "+Y:"")),z="IE",Y=O[1]),H){if(h(g,"global"))if(P&&(O=P.lang.System,W=O.getProperty("os.arch"),J=J||O.getProperty("os.name")+" "+O.getProperty("os.version")),k){try{Y=g.require("ringo/engine").version.join("."),z="RingoJS"}catch(Q){(O=g.system)&&O.global.system==g.system&&(z="Narwhal",J||(J=O[0].os||null))}z||(z="Rhino")}else"object"==typeof g.process&&!g.process.browser&&(O=g.process)&&("object"==typeof O.versions&&("string"==typeof O.versions.electron?(B.push("Node "+O.versions.node),z="Electron",Y=O.versions.electron):"string"==typeof O.versions.nw&&(B.push("Chromium "+Y,"Node "+O.versions.node),z="NW.js",Y=O.versions.nw)),z||(z="Node.js",W=O.arch,J=O.platform,Y=/[\d.]+/.exec(O.version),Y=Y?Y[0]:null));else u(O=g.runtime)==A?(z="Adobe AIR",J=O.flash.system.Capabilities.os):u(O=g.phantom)==D?(z="PhantomJS",Y=(O=O.version||null)&&O.major+"."+O.minor+"."+O.patch):"number"==typeof L.documentMode&&(O=/\bTrident\/(\d+)/i.exec(t))?(Y=[Y,L.documentMode],(O=+O[1]+4)!=Y[1]&&(B.push("IE "+Y[1]+" mode"),V&&(V[1]=""),Y[1]=O),Y="IE"==z?String(Y[1].toFixed(1)):Y[0]):"number"==typeof L.documentMode&&/^(?:Chrome|Firefox)\b/.test(z)&&(B.push("masking as "+z+" "+Y),z="IE",Y="11.0",V=["Trident"],J="Windows");J=J&&c(J)}if(Y&&(O=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(Y)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(H&&_.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(F=/b/i.test(O)?"beta":"alpha",Y=Y.replace(RegExp(O+"\\+?$"),"")+("beta"==F?j:N)+(/\d+\+?/.exec(O)||"")),"Fennec"==z||"Firefox"==z&&/\b(?:Android|Firefox OS)\b/.test(J))z="Firefox Mobile";else if("Maxthon"==z&&Y)Y=Y.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(K))"Xbox 360"==K&&(J=null),"Xbox 360"==K&&/\bIEMobile\b/.test(t)&&B.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(z)&&(!z||K||/Browser|Mobi/.test(z))||"Windows CE"!=J&&!/Mobi/i.test(t))if("IE"==z&&H)try{null===g.external&&B.unshift("platform preview")}catch(Q){B.unshift("embedded")}else(/\bBlackBerry\b/.test(K)||/\bBB10\b/.test(t))&&(O=(RegExp(K.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||Y)?(O=[O,/BB10/.test(t)],J=(O[1]?(K=null,G="BlackBerry"):"Device Software")+" "+O[0],Y=null):this!=l&&"Wii"!=K&&(H&&U||/Opera/.test(z)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==z&&/\bOS X (?:\d+\.){2,}/.test(J)||"IE"==z&&(J&&!/^Win/.test(J)&&Y>5.5||/\bWindows XP\b/.test(J)&&Y>8||8==Y&&!/\bTrident\b/.test(t)))&&!C.test(O=v.call(l,t.replace(C,"")+";"))&&O.name&&(O="ing as "+O.name+((O=O.version)?" "+O:""),C.test(z)?(/\bIE\b/.test(O)&&"Mac OS"==J&&(J=null),O="identify"+O):(O="mask"+O,z=R?c(R.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(O)&&(J=null),H||(Y=null)),V=["Presto"],B.push(O));else z+=" Mobile";(O=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(O=[parseFloat(O.replace(/\.(\d)$/,".0$1")),O],"Safari"==z&&"+"==O[1].slice(-1)?(z="WebKit Nightly",F="alpha",Y=O[1].slice(0,-1)):Y!=O[1]&&Y!=(O[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(Y=null),O[1]=(/\bChrome\/([\d.]+)/i.exec(t)||0)[1],537.36==O[0]&&537.36==O[2]&&parseFloat(O[1])>=28&&"WebKit"==V&&(V=["Blink"]),H&&(T||O[1])?(V&&(V[1]="like Chrome"),O=O[1]||(O=O[0],O<530?1:O<532?2:O<532.05?3:O<533?4:O<534.03?5:O<534.07?6:O<534.1?7:O<534.13?8:O<534.16?9:O<534.24?10:O<534.3?11:O<535.01?12:O<535.02?"13+":O<535.07?15:O<535.11?16:O<535.19?17:O<536.05?18:O<536.1?19:O<537.01?20:O<537.11?"21+":O<537.13?23:O<537.18?24:O<537.24?25:O<537.36?26:"Blink"!=V?"27":"28")):(V&&(V[1]="like Safari"),O=O[0],O=O<400?1:O<500?2:O<526?3:O<533?4:O<534?"4+":O<535?5:O<537?6:O<538?7:O<601?8:"8"),V&&(V[1]+=" "+(O+="number"==typeof O?".x":/[.+]/.test(O)?"":"+")),"Safari"==z&&(!Y||parseInt(Y)>45)&&(Y=O)),"Opera"==z&&(O=/\bzbov|zvav$/.exec(J))?(z+=" ",B.unshift("desktop mode"),"zvav"==O?(z+="Mini",Y=null):z+="Mobile",J=J.replace(RegExp(" *"+O+"$"),"")):"Safari"==z&&/\bChrome\b/.exec(V&&V[1])&&(B.unshift("desktop mode"),z="Chrome Mobile",Y=null,/\bOS X\b/.test(J)?(G="Apple",J="iOS 4.3+"):J=null),Y&&0==Y.indexOf(O=/[\d.]+$/.exec(J))&&t.indexOf("/"+O+"-")>-1&&(J=p(J.replace(O,""))),V&&!/\b(?:Avant|Nook)\b/.test(z)&&(/Browser|Lunascape|Maxthon/.test(z)||"Safari"!=z&&/^iOS/.test(J)&&/\bSafari\b/.test(V[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(z)&&V[1])&&(O=V[V.length-1])&&B.push(O),B.length&&(B=["("+B.join("; ")+")"]),G&&K&&K.indexOf(G)<0&&B.push("on "+G),K&&B.push((/^on /.test(B[B.length-1])?"":"on ")+K),J&&(O=/ ([\d.+]+)$/.exec(J),S=O&&"/"==J.charAt(J.length-O[0].length-1),J={architecture:32,family:O&&!S?J.replace(O[0],""):J,version:O?O[1]:null,toString:function(){var t=this.version;return this.family+(t&&!S?" "+t:"")+(64==this.architecture?" 64-bit":"")}}),(O=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(W))&&!/\bi686\b/i.test(W)?(J&&(J.architecture=64,J.family=J.family.replace(RegExp(" *"+O),"")),z&&(/\bWOW64\b/i.test(t)||H&&/\w(?:86|32)$/.test(_.cpuClass||_.platform)&&!/\bWin64; x64\b/i.test(t))&&B.unshift("32-bit")):J&&/^OS X/.test(J.family)&&"Chrome"==z&&parseFloat(Y)>=39&&(J.architecture=64),t||(t=null);var $={};return $.description=t,$.layout=V&&V[0],$.manufacturer=G,$.name=z,$.prerelease=F,$.product=K,$.ua=t,$.version=z&&Y,$.os=J||{architecture:null,family:null,version:null,toString:function(){return"null"}},$.parse=v,$.toString=b,$.version&&B.unshift(Y),$.name&&B.unshift(z),J&&z&&(J!=String(J).split(" ")[0]||J!=z.split(" ")[0]&&!K)&&B.push(K?"("+J+")":"on "+J),B.length&&($.description=B.join(" ")),$}var b={"function":!0,object:!0},y=b[typeof window]&&window||this,g=b[typeof e]&&e,m=b[typeof t]&&t&&!t.nodeType&&t,_=g&&m&&"object"==typeof o&&o;!_||_.global!==_&&_.window!==_&&_.self!==_||(y=_);var w=Math.pow(2,53)-1,C=/\bOpera/,O=Object.prototype,S=O.hasOwnProperty,I=O.toString,T=v();y.platform=T,i=function(){return T}.call(e,n,e,t),!(void 0!==i&&(t.exports=i))}).call(this)}).call(e,n(57)(t),function(){return this}())},function(t,e,n){var i=n(12),o=n(2).document,r=i(o)&&i(o.createElement);t.exports=function(t){return r?o.createElement(t):{}}},,function(t,e){"use strict";e.__esModule=!0;var n,i,o,r,s={CONTROL_COMMAND_BUSY:9,CONTROL_COMMAND_SELF_ON_BACKGROUND:12,CONTROL_COMMAND_START_NOTIFY_RECEIVED:13},a={NETCALL_CONTROL_COMMAND_NOTIFY_AUDIO_ON:1,NETCALL_CONTROL_COMMAND_NOTIFY_AUDIO_OFF:2,NETCALL_CONTROL_COMMAND_NOTIFY_VIDEO_ON:3,NETCALL_CONTROL_COMMAND_NOTIFY_VIDEO_OFF:4,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO:5,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_AGREE:6,NETCALL_CONTROL_COMMAND_SWITCH_AUDIO_TO_VIDEO_REJECT:7,NETCALL_CONTROL_COMMAND_SWITCH_VIDEO_TO_AUDIO:8,NETCALL_CONTROL_COMMAND_BUSY:9,NETCALL_CONTROL_COMMAND_SELF_CAMERA_INVALID:10,NETCALL_CONTROL_COMMAND_SELF_AUDIO_INVALID:11,NETCALL_CONTROL_COMMAND_SELF_ON_BACKGROUND:12,NETCALL_CONTROL_COMMAND_START_NOTIFY_RECEIVED:13,NETCALL_CONTROL_COMMAND_NOTIFY_RECORD_START:14,NETCALL_CONTROL_COMMAND_NOTIFY_RECORD_STOP:15},c={HANGUP_TYPE_NORMAL:0,HANGUP_TYPE_TIMEOUT:-1},l={NETCALL_TYPE_AUDIO:1,NETCALL_TYPE_VIDEO:2,
DEVICE_TYPE_AUDIO_IN:0,DEVICE_TYPE_AUDIO_OUT_LOCAL:1,DEVICE_TYPE_AUDIO_OUT_CHAT:2,DEVICE_TYPE_VIDEO:3,DEVICE_TYPE_DESKTOP_SCREEN:4,DEVICE_TYPE_DESKTOP_WINDOW:5,CHAT_VIDEO_QUALITY_NORMAL:0,CHAT_VIDEO_QUALITY_LOW:1,CHAT_VIDEO_QUALITY_MEDIUM:2,CHAT_VIDEO_QUALITY_HIGH:3,CHAT_VIDEO_QUALITY_480P:4,CHAT_VIDEO_QUALITY_540P:5,CHAT_VIDEO_QUALITY_720P:6,CHAT_VIDEO_FRAME_RATE_NORMAL:0,CHAT_VIDEO_FRAME_RATE_5:1,CHAT_VIDEO_FRAME_RATE_10:2,CHAT_VIDEO_FRAME_RATE_15:3,CHAT_VIDEO_FRAME_RATE_20:4,CHAT_VIDEO_FRAME_RATE_25:5,LAYOUT_SPLITBOTTOMHORFLOATING:0,LAYOUT_SPLITTOPHORFLOATING:1,LAYOUT_SPLITLATTICETILE:2,LAYOUT_SPLITLATTICECUTTINGTILE:3,LAYOUT_SPLITCUSTOM:4,ROLE_PLAYER:0,ROLE_AUDIENCE:1},u={WB_TYPE_TCP:2,WB_TYPE_UDP:3,CALL_TYPE_NONE:0,CALL_TYPE_AUDIO:1,HANGUP_TYPE_NORMAL:0,HANGUP_TYPE_TIMEOUT:-1};l.deviceTypeMap=(n={},n[l.DEVICE_TYPE_AUDIO_IN]="audioIn",n[l.DEVICE_TYPE_AUDIO_OUT_CHAT]="audioOut",n[l.DEVICE_TYPE_VIDEO]="video",n),l.deviceTypeMap=(i={},i[l.DEVICE_TYPE_AUDIO_IN]="audioIn",i[l.DEVICE_TYPE_AUDIO_OUT_LOCAL]="audioOut",i[l.DEVICE_TYPE_AUDIO_OUT_CHAT]="audioOut",i[l.DEVICE_TYPE_VIDEO]="video",i),l.videoMap={frame:(o={},o[l.CHAT_VIDEO_QUALITY_NORMAL]="480x320",o[l.CHAT_VIDEO_QUALITY_LOW]="176x144",o[l.CHAT_VIDEO_QUALITY_MEDIUM]="352x288",o[l.CHAT_VIDEO_QUALITY_HIGH]="480x320",o[l.CHAT_VIDEO_QUALITY_480P]="640x480",o[l.CHAT_VIDEO_QUALITY_540P]="960x540",o[l.CHAT_VIDEO_QUALITY_720P]="1280x720",o),frameRate:(r={},r[l.CHAT_VIDEO_FRAME_RATE_NORMAL]=15,r[l.CHAT_VIDEO_FRAME_RATE_5]=5,r[l.CHAT_VIDEO_FRAME_RATE_10]=10,r[l.CHAT_VIDEO_FRAME_RATE_15]=15,r[l.CHAT_VIDEO_FRAME_RATE_20]=20,r[l.CHAT_VIDEO_FRAME_RATE_25]=25,r)};var h={getVideoSessionConfig:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.quality,n=void 0===e?l.CHAT_VIDEO_QUALITY_NORMAL:e,i=t.frameRate,o=void 0===i?l.CHAT_VIDEO_FRAME_RATE_NORMAL:i,r={},s=l.videoMap.frame[n];return r.frameRate=l.videoMap.frameRate[o],r.width=+s.split("x")[0],r.height=+s.split("x")[1],r},getDeviceTypeStr:function(t){return l.deviceTypeMap[t]},getDeviceTypeMap:function(t){return l.deviceTypeMap[t]}},f=Object.assign(l,a,c),d=Object.assign(u,s,c);e.constantTool=h,e.constantRtc=f,e.constantBB=d},,function(t,e,n){t.exports=!n(8)&&!n(19)(function(){return 7!=Object.defineProperty(n(47)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){"use strict";var i=n(29),o=n(18),r=n(55),s=n(9),a=n(6),c=n(26),l=n(83),u=n(30),h=n(88),f=n(3)("iterator"),d=!([].keys&&"next"in[].keys()),p="@@iterator",v="keys",b="values",y=function(){return this};t.exports=function(t,e,n,g,m,_,w){l(n,e,g);var C,O,S,I=function(t){if(!d&&t in E)return E[t];switch(t){case v:return function(){return new n(this,t)};case b:return function(){return new n(this,t)}}return function(){return new n(this,t)}},T=e+" Iterator",x=m==b,A=!1,E=t.prototype,M=E[f]||E[p]||m&&E[m],D=!d&&M||I(m),P=m?x?I("entries"):D:void 0,k="Array"==e?E.entries||M:M;if(k&&(S=h(k.call(new t)),S!==Object.prototype&&S.next&&(u(S,T,!0),i||a(S,f)||s(S,f,y))),x&&M&&M.name!==b&&(A=!0,D=function(){return M.call(this)}),i&&!w||!d&&!A&&E[f]||s(E,f,D),c[e]=D,c[T]=y,m)if(C={values:x?D:I(b),keys:_?D:I(v),entries:P},w)for(O in C)O in E||r(E,O,C[O]);else o(o.P+o.F*(d||A),e,C);return C}},function(t,e,n){var i=n(54),o=n(33).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,o)}},function(t,e,n){var i=n(6),o=n(13),r=n(80)(!1),s=n(34)("IE_PROTO");t.exports=function(t,e){var n,a=o(t),c=0,l=[];for(n in a)n!=s&&i(a,n)&&l.push(n);for(;e.length>c;)i(a,n=e[c++])&&(~r(l,n)||l.push(n));return l}},function(t,e,n){t.exports=n(9)},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e,n){var i=n(41);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){var i=n(25),o=n(21),r=n(13),s=n(37),a=n(6),c=n(51),l=Object.getOwnPropertyDescriptor;e.f=n(8)?l:function(t,e){if(t=r(t),e=s(e,!0),c)try{return l(t,e)}catch(n){}if(a(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e,n){var i=n(32);t.exports=function(t){return Object(i(t))}},function(t,e){"use strict";e.__esModule=!0;var n,i,o={CURRENT:{SDK_TYPE:null},SDK_TYPE:{NETCALL:1,WEBRTC:2,WHITEBOARD:3,NRTC:4},SDK_NAME:{1:"Netcall",2:"WebRTC",3:"WhiteBoard",4:"NRTC"}};o.STATS_FUN=(n={},n[o.SDK_TYPE.NETCALL]=1,n[o.SDK_TYPE.WEBRTC]=1,n[o.SDK_TYPE.NRTC]=1,n[o.SDK_TYPE.WHITEBOARD]=0,n),o.STATS_RTC=(i={},i[o.SDK_TYPE.WEBRTC]=1,i[o.SDK_TYPE.NRTC]=1,i[o.SDK_TYPE.WHITEBOARD]=0,i),e["default"]=o,t.exports=e["default"]},,,,,,,function(t,e,n){var i=n(2).document;t.exports=i&&i.documentElement},function(t,e,n){var i=n(36),o=Math.min;t.exports=function(t){return t>0?o(i(t),9007199254740991):0}},function(t,e){},function(t,e,n){"use strict";var i=n(89)(!0);n(52)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){n(91);for(var i=n(2),o=n(9),r=n(26),s=n(3)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<a.length;c++){var l=a[c],u=i[l],h=u&&u.prototype;h&&!h[s]&&o(h,s,l),r[l]=r.Array}},,,function(t,e,n){t.exports={"default":n(77),__esModule:!0}},function(t,e,n){t.exports={"default":n(78),__esModule:!0}},function(t,e,n){n(92),n(70),n(93),n(94),t.exports=n(11).Symbol},function(t,e,n){n(71),n(72),t.exports=n(39).f("iterator")},function(t,e){t.exports=function(){}},function(t,e,n){var i=n(13),o=n(69),r=n(90);t.exports=function(t){return function(e,n,s){var a,c=i(e),l=o(c.length),u=r(s,l);if(t&&n!=n){for(;l>u;)if(a=c[u++],a!=a)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}}},function(t,e,n){var i=n(24),o=n(43),r=n(25);t.exports=function(t){var e=i(t),n=o.f;if(n)for(var s,a=n(t),c=r.f,l=0;a.length>l;)c.call(t,s=a[l++])&&e.push(s);return e}},function(t,e,n){var i=n(41);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){"use strict";var i=n(42),o=n(21),r=n(30),s={};n(9)(s,n(3)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(s,{next:o(1,n)}),r(t,e+" Iterator")}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var i=n(22)("meta"),o=n(12),r=n(6),s=n(10).f,a=0,c=Object.isExtensible||function(){return!0},l=!n(19)(function(){return c(Object.preventExtensions({}))}),u=function(t){s(t,i,{value:{i:"O"+ ++a,w:{}}})},h=function(t,e){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,i)){if(!c(t))return"F";if(!e)return"E";u(t)}return t[i].i},f=function(t,e){if(!r(t,i)){if(!c(t))return!0;if(!e)return!1;u(t)}return t[i].w},d=function(t){return l&&p.NEED&&c(t)&&!r(t,i)&&u(t),t},p=t.exports={KEY:i,NEED:!1,fastKey:h,getWeak:f,onFreeze:d}},function(t,e,n){var i=n(10),o=n(14),r=n(24);t.exports=n(8)?Object.defineProperties:function(t,e){o(t);for(var n,s=r(e),a=s.length,c=0;a>c;)i.f(t,n=s[c++],e[n]);return t}},function(t,e,n){var i=n(13),o=n(53).f,r={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(t){try{return o(t)}catch(e){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==r.call(t)?a(t):o(i(t))}},function(t,e,n){var i=n(6),o=n(60),r=n(34)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),i(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){var i=n(36),o=n(32);t.exports=function(t){return function(e,n){var r,s,a=String(o(e)),c=i(n),l=a.length;return c<0||c>=l?t?"":void 0:(r=a.charCodeAt(c),r<55296||r>56319||c+1===l||(s=a.charCodeAt(c+1))<56320||s>57343?t?a.charAt(c):r:t?a.slice(c,c+2):(r-55296<<10)+(s-56320)+65536)}}},function(t,e,n){var i=n(36),o=Math.max,r=Math.min;t.exports=function(t,e){return t=i(t),t<0?o(t+e,0):r(t,e)}},function(t,e,n){"use strict";var i=n(79),o=n(84),r=n(26),s=n(13);t.exports=n(52)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,o(1)):"keys"==e?o(0,n):"values"==e?o(0,t[n]):o(0,[n,t[n]])},"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},function(t,e,n){"use strict";var i=n(2),o=n(6),r=n(8),s=n(18),a=n(55),c=n(85).KEY,l=n(19),u=n(35),h=n(30),f=n(22),d=n(3),p=n(39),v=n(38),b=n(81),y=n(82),g=n(14),m=n(12),_=n(13),w=n(37),C=n(21),O=n(42),S=n(87),I=n(59),T=n(10),x=n(24),A=I.f,E=T.f,M=S.f,D=i.Symbol,P=i.JSON,k=P&&P.stringify,N="prototype",j=d("_hidden"),L=d("toPrimitive"),U={}.propertyIsEnumerable,R=u("symbol-registry"),W=u("symbols"),B=u("op-symbols"),F=Object[N],H="function"==typeof D,Y=i.QObject,V=!Y||!Y[N]||!Y[N].findChild,z=r&&l(function(){return 7!=O(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=A(F,e);i&&delete F[e],E(t,e,n),i&&t!==F&&E(F,e,i)}:E,K=function(t){var e=W[t]=O(D[N]);return e._k=t,e},G=H&&"symbol"==typeof D.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof D},J=function(t,e,n){return t===F&&J(B,e,n),g(t),e=w(e,!0),g(n),o(W,e)?(n.enumerable?(o(t,j)&&t[j][e]&&(t[j][e]=!1),n=O(n,{enumerable:C(0,!1)})):(o(t,j)||E(t,j,C(1,{})),t[j][e]=!0),z(t,e,n)):E(t,e,n)},Q=function(t,e){g(t);for(var n,i=b(e=_(e)),o=0,r=i.length;r>o;)J(t,n=i[o++],e[n]);return t},$=function(t,e){return void 0===e?O(t):Q(O(t),e)},X=function(t){var e=U.call(this,t=w(t,!0));return!(this===F&&o(W,t)&&!o(B,t))&&(!(e||!o(this,t)||!o(W,t)||o(this,j)&&this[j][t])||e)},q=function(t,e){if(t=_(t),e=w(e,!0),t!==F||!o(W,e)||o(B,e)){var n=A(t,e);return!n||!o(W,e)||o(t,j)&&t[j][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=M(_(t)),i=[],r=0;n.length>r;)o(W,e=n[r++])||e==j||e==c||i.push(e);return i},tt=function(t){for(var e,n=t===F,i=M(n?B:_(t)),r=[],s=0;i.length>s;)!o(W,e=i[s++])||n&&!o(F,e)||r.push(W[e]);return r};H||(D=function(){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===F&&e.call(B,n),o(this,j)&&o(this[j],t)&&(this[j][t]=!1),z(this,t,C(1,n))};return r&&V&&z(F,t,{configurable:!0,set:e}),K(t)},a(D[N],"toString",function(){return this._k}),I.f=q,T.f=J,n(53).f=S.f=Z,n(25).f=X,n(43).f=tt,r&&!n(29)&&a(F,"propertyIsEnumerable",X,!0),p.f=function(t){return K(d(t))}),s(s.G+s.W+s.F*!H,{Symbol:D});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)d(et[nt++]);for(var it=x(d.store),ot=0;it.length>ot;)v(it[ot++]);s(s.S+s.F*!H,"Symbol",{"for":function(t){return o(R,t+="")?R[t]:R[t]=D(t)},keyFor:function(t){if(!G(t))throw TypeError(t+" is not a symbol!");for(var e in R)if(R[e]===t)return e},useSetter:function(){V=!0},useSimple:function(){V=!1}}),s(s.S+s.F*!H,"Object",{create:$,defineProperty:J,defineProperties:Q,getOwnPropertyDescriptor:q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),P&&s(s.S+s.F*(!H||l(function(){var t=D();return"[null]"!=k([t])||"{}"!=k({a:t})||"{}"!=k(Object(t))})),"JSON",{stringify:function(t){for(var e,n,i=[t],o=1;arguments.length>o;)i.push(arguments[o++]);if(n=e=i[1],(m(e)||void 0!==t)&&!G(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!G(e))return e}),i[1]=e,k.apply(P,i)}}),D[N][L]||n(9)(D[N],L,D[N].valueOf),h(D,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){n(38)("asyncIterator")},function(t,e,n){n(38)("observable")},function(t,e,n){var i,o;!function(r,s){"use strict";i=s,o="function"==typeof i?i.call(e,n,e,t):i,!(void 0!==o&&(t.exports=o))}(this,function(){var t,e,n,i,o=Function.call,r=Object.prototype,s=o.bind(r.hasOwnProperty),a=o.bind(r.propertyIsEnumerable),c=o.bind(r.toString),l=s(r,"__defineGetter__");l&&(t=o.bind(r.__defineGetter__),e=o.bind(r.__defineSetter__),n=o.bind(r.__lookupGetter__),i=o.bind(r.__lookupSetter__));var u=function(t){return null==t||"object"!=typeof t&&"function"!=typeof t};Object.getPrototypeOf||(Object.getPrototypeOf=function(t){var e=t.__proto__;return e||null===e?e:"[object Function]"===c(t.constructor)?t.constructor.prototype:t instanceof Object?r:null});var h=function(t){try{return t.sentinel=0,0===Object.getOwnPropertyDescriptor(t,"sentinel").value}catch(e){return!1}};if(Object.defineProperty){var f=h({}),d="undefined"==typeof document||h(document.createElement("div"));if(!d||!f)var p=Object.getOwnPropertyDescriptor}if(!Object.getOwnPropertyDescriptor||p){var v="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(t,e){if(u(t))throw new TypeError(v+t);if(p)try{return p.call(Object,t,e)}catch(o){}var c;if(!s(t,e))return c;if(c={enumerable:a(t,e),configurable:!0},l){var h=t.__proto__,f=t!==r;f&&(t.__proto__=r);var d=n(t,e),b=i(t,e);if(f&&(t.__proto__=h),d||b)return d&&(c.get=d),b&&(c.set=b),c}return c.value=t[e],c.writable=!0,c}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)}),!Object.create){var b,y=!({__proto__:null}instanceof Object),g=function(){if(!document.domain)return!1;try{return!!new ActiveXObject("htmlfile")}catch(t){return!1}},m=function(){var t,e;e=new ActiveXObject("htmlfile");var n="script";return e.write("<"+n+"></"+n+">"),e.close(),t=e.parentWindow.Object.prototype,e=null,t},_=function(){var t,e=document.createElement("iframe"),n=document.body||document.documentElement;return e.style.display="none",n.appendChild(e),e.src="javascript:",t=e.contentWindow.Object.prototype,n.removeChild(e),e=null,t};b=y||"undefined"==typeof document?function(){return{__proto__:null}}:function(){var t=g()?m():_();delete t.constructor,delete t.hasOwnProperty,delete t.propertyIsEnumerable,delete t.isPrototypeOf,delete t.toLocaleString,delete t.toString,delete t.valueOf;var e=function(){};return e.prototype=t,b=function(){return new e},new e},Object.create=function(t,e){var n,i=function(){};if(null===t)n=b();else{if(null!==t&&u(t))throw new TypeError("Object prototype may only be an Object or null");i.prototype=t,n=new i,n.__proto__=t}return void 0!==e&&Object.defineProperties(n,e),n}}var w=function(t){try{return Object.defineProperty(t,"sentinel",{}),"sentinel"in t}catch(e){return!1}};if(Object.defineProperty){var C=w({}),O="undefined"==typeof document||w(document.createElement("div"));if(!C||!O)var S=Object.defineProperty,I=Object.defineProperties}if(!Object.defineProperty||S){var T="Property description must be an object: ",x="Object.defineProperty called on non-object: ",A="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(o,s,a){if(u(o))throw new TypeError(x+o);if(u(a))throw new TypeError(T+a);if(S)try{return S.call(Object,o,s,a)}catch(c){}if("value"in a)if(l&&(n(o,s)||i(o,s))){var h=o.__proto__;o.__proto__=r,delete o[s],o[s]=a.value,o.__proto__=h}else o[s]=a.value;else{var f="get"in a,d="set"in a;if(!l&&(f||d))throw new TypeError(A);f&&t(o,s,a.get),d&&e(o,s,a.set)}return o}}Object.defineProperties&&!I||(Object.defineProperties=function(t,e){if(I)try{return I.call(Object,t,e)}catch(n){}return Object.keys(e).forEach(function(n){"__proto__"!==n&&Object.defineProperty(t,n,e[n])}),t}),Object.seal||(Object.seal=function(t){if(Object(t)!==t)throw new TypeError("Object.seal can only be called on Objects.");return t}),Object.freeze||(Object.freeze=function(t){if(Object(t)!==t)throw new TypeError("Object.freeze can only be called on Objects.");return t});try{Object.freeze(function(){})}catch(E){Object.freeze=function(t){return function(e){return"function"==typeof e?e:t(e)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(t){if(Object(t)!==t)throw new TypeError("Object.preventExtensions can only be called on Objects.");return t}),Object.isSealed||(Object.isSealed=function(t){if(Object(t)!==t)throw new TypeError("Object.isSealed can only be called on Objects.");return!1}),Object.isFrozen||(Object.isFrozen=function(t){if(Object(t)!==t)throw new TypeError("Object.isFrozen can only be called on Objects.");return!1}),Object.isExtensible||(Object.isExtensible=function(t){if(Object(t)!==t)throw new TypeError("Object.isExtensible can only be called on Objects.");for(var e="";s(t,e);)e+="?";t[e]=!0;var n=s(t,e);return delete t[e],n})})},function(t,e){},,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(120),r=i(o);e["default"]=r["default"]||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}},,,,,,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(7),r=i(o),s=n(40),a=n(4),c=a.info.nrtcVersion,l="https://statistic.live.126.net/statistic/realtime/sdkFunctioninfo",u=function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r["default"])(this,f);var e=t.appkey,n=t.platform;this.apis={},this.isRtc=/WebRTC/.test(n),this.init(e,n),this.resetStatus()};e["default"]=u;var h=u.prototype;h.init=function(t,e){this.apis=Object.assign(this.apis,{ver:1,platform:e,sdk_ver:c||"v4.4.0",uid:null,appkey:t,time:null})},h.start=function(t){this.calling=!0,this.apis=Object.assign(this.apis,t)},h.resetStatus=function(){this.calling=!1,this.apis=Object.assign(this.apis,{p2p:{value:0},meeting:{value:0},bypass:{value:0},call_control_type:{value:0},self_mute:{value:-1},self_mic_mute:{value:-1},switch_p2p_type:{value:0},set_speaker:{value:-1},net_detect:{value:this.isRtc?-1:0},beautify:{value:-1},water_mark:{value:-1},audio_samples:{value:-1},video_samples:{value:-1},pre_view_mirror:{value:-1},code_mirror:{value:-1},custom_audio:{value:-1},custom_video:{value:-1},audio_mix:{value:-1},snap_shot:{value:-1},record:{value:0},audio_record:{value:0},display:{value:0},android_compatibility:{value:-1},hd_audio:{value:0},video_quality:{value:0},fps:{value:0},prefered_video_encoder:{value:-1},prefered_video_decoder:{value:-1},video_max_encode_bitrate:{value:this.isRtc?-1:0},audio_scene:{value:-1},video_adaptive_strategy:{value:this.isRtc?-1:0},ans:{value:this.isRtc?-1:0},agc:{value:-1},dtx:{value:-1},aec:{value:this.isRtc?-1:0},awc:{value:this.isRtc?-1:0}})},h.update=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],n=t.key,i=t.ext;t.constructor===String&&(n=t),i=i||e,this.apis[n]&&(this.apis[n].value=1,void 0!==i&&(this.apis[n].ext=i),/(p2p|meeting)/.test(n)&&(this.calling=!0))},h.send=function(){var t=this;this.calling&&(this.calling=!1,this.apis.time=Date.now(),(0,s.ajax)({type:"post",url:l,data:this.apis}).then(function(e){t.resetStatus()})["catch"](function(e){console.log("err",e),t.resetStatus()}))},t.exports=e["default"]},,,function(t,e){"use strict";e.__esModule=!0,e["default"]=function(t){if(!t.url||!t.data)return Promise.reject("参数不完整，无法发起请求");t.dataType=t.dataType||"json";var e=new XMLHttpRequest;return e.open(t.type||"GET",t.url,!0),e.responseType=""+t.dataType,e.setRequestHeader("Content-type","application/json;charset=UTF-8"),t.header&&Object.keys(t.header).map(function(n){e.setRequestHeader(n,t.header[n])}),new Promise(function(n,i){e.onload=function(){var t=e.response;n(t)},e.onerror=function(t){i(t)},e.send(JSON.stringify(t.data))})};t.exports=e["default"]},function(t,e){"use strict";e.__esModule=!0,e["default"]={merge:function(){var t=arguments;return t[0]=Object.assign.apply(Object.assign,arguments),t[0]},verifyOptions:function(){var t=arguments;if(t[0]&&t[0].constructor===Object)for(var e=1;e<arguments.length;e++){var n=t[e];n=n.split(" "),n.map(function(e){if(!t[0][e])throw Error("参数缺失 "+e)})}},guid:function(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return function(){return t()+t()+t()+t()+t()+t()+t()+t()}}()},t.exports=e["default"]},,function(t,e,n){"use strict";function i(t,e){for(var n in e)t[n]=e[n];return t}n(95),n(46),n(5).Promise,window.Object.assign||(console.log("Object.assign polyfill"),window.Object.assign=function(){for(var t=arguments,e=1;e<t.length;e++)t[0]=i(t[0],t[e]);return t[0]})},,,,,,function(t,e){"use strict";e.__esModule=!0,e["default"]={html2node:function(t){var e=document.createElement("div");e.innerHTML=t;var n,i,o=[];if(e.children)for(n=0,i=e.children.length;n<i;n++)o.push(e.children[n]);else for(n=0,i=e.childNodes.length;n<i;n++){var r=e.childNodes[n];1===r.nodeType&&o.push(r)}return o.length>1?e:o[0]},n2node:function(t){return t?/HTML.+Element/gi.test(t)?t:t[0]&&/HTML.+Element/gi.test(t[0])?t[0]:null:null}},t.exports=e["default"]},function(t,e){"use strict";e.__esModule=!0;var n={gateWay:{login:1,loginAck:2,join:3,keep_alive:4,keep_alive_ack:5,keep_alive_node:6,broadcast:7,toUser:8,logout:9}},i={gateWay:{1:"login",2:"loginAck",3:"join",4:"keep_alive",5:"keep_alive_ack",6:"keep_alive_node",7:"broadcast",8:"toUser",9:"logout"}};e.serializeWb=n,e.unserializeWb=i},function(t,e,n){t.exports={"default":n(125),__esModule:!0}},function(t,e,n){t.exports={"default":n(126),__esModule:!0}},function(t,e,n){t.exports={"default":n(127),__esModule:!0}},,,function(t,e,n){n(130),t.exports=n(11).Object.assign},function(t,e,n){n(131);var i=n(11).Object;t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){n(132),t.exports=n(11).Object.setPrototypeOf},function(t,e,n){"use strict";var i=n(24),o=n(43),r=n(25),s=n(60),a=n(58),c=Object.assign;t.exports=!c||n(19)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=c({},t)[n]||Object.keys(c({},e)).join("")!=i})?function(t,e){for(var n=s(t),c=arguments.length,l=1,u=o.f,h=r.f;c>l;)for(var f,d=a(arguments[l++]),p=u?i(d).concat(u(d)):i(d),v=p.length,b=0;v>b;)h.call(d,f=p[b++])&&(n[f]=d[f]);return n}:c},function(t,e,n){var i=n(12),o=n(14),r=function(t,e){if(o(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n(45)(Function.call,n(59).f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(o){e=!0}return function(t,n){return r(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:r}},function(t,e,n){var i=n(18);i(i.S+i.F,"Object",{assign:n(128)})},function(t,e,n){var i=n(18);i(i.S,"Object",{create:n(42)})},function(t,e,n){var i=n(18);i(i.S,"Object",{setPrototypeOf:n(129).set})},,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(7),r=i(o),s=n(17),a=i(s),c=n(16),l=i(c),u=n(61),h=i(u),f=n(119),d=n(20),p=function(t){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r["default"])(this,e);var i=(0,a["default"])(this,t.call(this));return i.info=Object.assign({},n),i.init(),i.logger=n.logger||window.console,i.autoReconnect=n.autoReconnect||!0,i.isDestroy=!1,i.reConnectCount=0,i.wssUrl=null,i}return(0,l["default"])(e,t),e}(d),v=p.prototype;v.init=function(){this.reset()},v.reset=function(){this.imInfo={}},v.connect=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.url,i=void 0===n?this.wssUrl:n,o=e.imInfo;return this.imInfo=o||this.imInfo,i?new Promise(function(e,n){t.url=i;var o=void 0;try{o=t.ws=new WebSocket("wss://"+i);var r=t;o.onopen=function(n){t.wssUrl=i,r.initSignal(),r.signalConnected=!0,console.log("signalConnected",i),r.emit("signalConnected"),e(r),t.heartbeat()},o.onclose=o.onerror=function(t){r.signalConnected=!1,n(t)}}catch(s){t.logger.error("信令连接建立失败",s),n(s)}}):Promise.reject("信令地址缺失")},v.initSignal=function(){var t=this,e=this.ws,n=e.send;e.send=function(t){n.call(this,JSON.stringify(t))},e.onmessage=function(e){var n=JSON.parse(e.data||null);if(n)return!t.isHeartBeating||"keep_alive_ack"!==n.type&&n.type!==f.serializeWb.gateWay.keep_alive_ack?void t.emit("message",n):void t.onHeartBeat(n)},e.onclose=function(e){t.signalConnected=!1,t.emit("signalTimeout",e)},e.onerror=function(e){t.signalConnected=!1,t.emit("signalError",e)}},v.send=function(t){var e=this;"keep_alive"!==t.type,this.ws&&this.signalConnected&&this.ws.readyState===this.ws.OPEN?(t.browser={},t.browser.name=window.platform.name,t.browser.version=window.platform.version,this.ws.send(t)):this.once("signalConnected",function(){e.send(t)})},v.heartbeat=function(){this.socketData=this.socketData||{uid:this.imInfo.uid,cid:this.imInfo.cid},this.heartBeatList=[],this.bindHearBeat(5)},v.onHeartBeat=function(t){this.heartBeatList.shift(),this.bindHearBeat(5)},v.heartBeatHandler=function(){var t=this.socketData,e=this.heartBeatList;if(e){var n=Date.now(),i=n;if(h["default"].CURRENT.SDK_TYPE===h["default"].SDK_TYPE.WHITEBOARD&&(i=+n.toString().slice(0,-3)),e.constructor===Array&&0===e.length){e.push(n);var o=this.getContentData({type:"keep_alive",uid:h["default"].CURRENT.SDK_TYPE===h["default"].SDK_TYPE.WHITEBOARD?+t.uid:t.uid+"",cid:h["default"].CURRENT.SDK_TYPE===h["default"].SDK_TYPE.WHITEBOARD?+t.cid:t.cid+""},i);return this.send(o),void this.bindHearBeat(5)}var r=Date.now()-e[0];if(r>3e4)this.logger.error("socket error: heartbeat timeout"),this.emit("signalTimeout");else if(r>2e3&&r<3e4){this.logger.warn("socket error: no response, keep heartbeat"),e.push(n);var s=this.getContentData({type:"keep_alive",uid:t.uid,cid:t.cid},i);this.send(s),this.bindHearBeat(2)}}},v.getContentData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];return h["default"].CURRENT.SDK_TYPE===h["default"].SDK_TYPE.WHITEBOARD?(t.version=31,t.type=f.serializeWb.gateWay[t.type],t.content={params:{timestamp:+e}}):t.params={content:{timestamp:e+""}},t},v.bindHearBeat=function(t){this.isHeartBeating&&clearTimeout(this.isHeartBeating),this.isHeartBeating=setTimeout(this.heartBeatHandler.bind(this),1e3*t)},v.stopHeartBeat=function(){this.isHeartBeating&&(this.isHeartBeating&&clearTimeout(this.isHeartBeating),this.heartBeatTimer&&clearInterval(this.heartBeatTimer),this.isHeartBeating=null,this.heartBeatTimer=null,this.heartBeatList=null,this.heartBeatCount=0)},v.logout=function(){var t=this.socketData,e=Date.now().toString(),n=this.getContentData({type:"logout",uid:t.uid,cid:t.cid},e);this.send(n)},v.destroy=function(){this.logger.log("signal close -> signal.js"),this.stopHeartBeat(),this.isDestroy=!0,this.ws&&(this.ws.onopen=null,this.ws.onmessage=null,this.ws.onerror=null,this.ws.onclose=null,this.ws.readyState===WebSocket.OPEN&&this.ws.close(),this.ws=null)},e["default"]=p,t.exports=e["default"]},,,,,,,,,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}var o=n(7),r=i(o),s=n(17),a=i(s),c=n(16),l=i(c),u=n(40),h=n(20),f=function(t){function e(n){(0,r["default"])(this,e);var i=(0,a["default"])(this,t.call(this));return n.container=u.element.n2node(n.container),n.remoteContainer=u.element.n2node(n.remoteContainer),u.tool.merge(i,n),i.init(),i}return(0,l["default"])(e,t),e}(h),d=f.prototype;d.init=function(){var t=this;this.resetStatus(),window.addEventListener("beforeunload",this.beforeunload.bind(this));var e=this.nim&&this.nim.logger||window.console;this.logger={log:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.debug&&e.log.apply(e,arguments)},error:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.debug&&e.error.apply(e,arguments)},warn:function(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.debug&&e.warn.apply(e,arguments)}}},d.resetStatus=function(){this.signalInited=!1,this.channelId=null,this.type=null,this.target={account:null,uid:null},this.sessionConfig={},this.sessionMode=null,this.imInfo={},this.calling=!1,this.isCaller=!1,this.callee=null,this.callAccepted=!1,this.callerInfo=null,this.beCalledInfo=null,this.nim&&(this.nim.protocol&&this.nim.protocol.setCurrentNetcall&&this.nim.protocol.setCurrentNetcall(),this.nim.protocol&&this.nim.protocol.setCurrentWhiteBoard&&this.nim.protocol.setCurrentWhiteBoard()),this.needQueryAccountMap={},this.accountUidMap={},this.uidAccountMap={},this.isOnHangup=!1},d.beforeunload=function(){this.signalInited&&(this.callerInfo||this.beCalledInfo?this.hangup():this.leaveChannel())},d.baseGetAccount=function(){return this.nim&&this.nim.account},d.baseGetUid=function(){return this.accountUidMap?this.accountUidMap[this.nim.account]||"-1":"-1"},d.parseAccountUidMap=function(t){var e=this;Object.keys(t).forEach(function(n){e.addAccountUidMap({account:n,uid:t[n]})})},d.addAccountUidMap=function(t){var e=t.account,n=t.uid;this.uidAccountMap||(this.uidAccountMap={}),this.uidAccountMap[n]=e,this.accountUidMap||(this.accountUidMap={}),this.accountUidMap[e]=n},d.getAccountWithUid=function(t){if(this.uidAccountMap)return this.uidAccountMap[t]},d.getUidWithAccount=function(t){if(this.accountUidMap)return this.accountUidMap[t]},d.baseIsCurrentChannelId=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.channelId&&this.channelId===t.channelId},d.baseNotCurrentChannelId=function(t){return!this.baseIsCurrentChannelId(t)},d.baseResponse=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.fn||"calleeAck",i=e.beCalledInfo||this.beCalledInfo,o=i.accepted=e.accepted!==!1;return o?(this.sessionMode="p2p",this.type=i.type,this.channelId=i.channelId,this.target.account=i.account,this.calling=!0,this.imInfo=i,this.imInfo.sessionMode=this.sessionMode,this.imInfo.role=0,this.setSessionConfig({signalStartTime:Date.now()})):(this.logger.log("reject call",i),this.packNetcallRecord({type:i.type,channelId:i.channelId,isCaller:!1,target:i.account,recordType:"rejectNetcall"})),this.nim[n](i).then(function(){o&&(e.sessionConfig&&t.setSessionConfig(e.sessionConfig),t.beCalledInfo=i,t.initSession({beCalledInfo:i}))},function(e){throw t.logger.log(e),e})},d.baseControl=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.channelId=e.channelId||this.channelId,e.command&&e.channelId){this.controller.uploadDataApi("update",{key:"call_control_type"});var n=e.fn||"netcallControl";return e.type=e.command,this.nim[n](e)["catch"](function(e){t.logger.log(e)})}},d.baseHangup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controller.uploadDataApi("send");var e=t.channelId,n=void 0===e?this.channelId:e,i=t.recordType;if(n){var o=t.fn||"hangup";this.nim[o]({channelId:n})}n===this.channelId&&(this.isCaller&&!this.callAccepted&&(this.logger.log(i,{channelId:n}),this.packNetcallRecord({recordType:i})),this.resetWhenHangup())},d.baseStartSession=function(){this.imInfo.cid=this.imInfo.cid||this.imInfo.channelId;var t=this.sessionMode=this.sessionMode||"p2p";this.imInfo.sessionMode=t,this.imInfo.sessionConfig=this.sessionConfig,this.imInfo.serverMap&&this.imInfo.serverMap.constructor===String&&(this.imInfo.serverMap=JSON.parse(this.imInfo.serverMap))},d.packNetcallRecord=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.recordType,n=t.type||this.type,i=t.channelId||this.channelId,o=t.duration||0,r=t.isCaller||this.isCaller,s=t.target||this.target.account,a=this.baseGetAccount(),c=r?a:s,l=r?s:a,h=+new Date;this.nim.protocol.onMsg({content:{msg:{attach:JSON.stringify({data:{calltype:n,channel:i,duration:o,ids:[a,s],time:h},id:e}),from:c,fromClientType:r?16:0,fromDeviceId:"",fromNick:"",idClient:u.tool.guid(),idServer:u.tool.guid(),scene:0,time:h,to:l,type:5}}})},d.setSessionConfig=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u.tool.merge(this.sessionConfig,t);
},d.initSignal=function(){return Promise.resolve()},d.initSession=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionMode="p2p";var n=this.isCaller?this.callerInfo:e.beCalledInfo;this.parseAccountUidMap(n.accountUidMap),!n.account&&n.uid&&(n.account=this.getAccountWithUid(n.uid)),this.callAccepted=!0,this.signalInited=!0,this.setSessionConfig({signalEndTime:Date.now()}),this.controller.uploadDataApi("start",{uid:n.uid}),this.target.uid=this.getUidWithAccount(this.target.account);var i={type:n.type,account:this.target&&this.target.account||n.account,channelId:n.channelId};n.netcallType&&(i.netcallType=n.netcallType),this.imInfo.target=this.target,setTimeout(function(){t.emit("callAccepted",i)},1)},d.onBeCalled=function(t){this.signalInited=!0,this.channelId=t.channelId,this.beCalledInfo=t,this.logger.log("beCalling",t),this.emit("beCalling",t)},d.onUserJoin=function(t){if(this.logger.log("client on userJoined",t),t.type=t.type||this.type,t.account=this.getAccountWithUid(t.uid),t.mode=this.sessionMode,t.account!==this.baseGetAccount()){if(t.account)return this.logger.log("userjoin ----> from signal",t),void this.emit("joinChannel",t);this.needQueryAccountMap[t.uid]=t;var e=this.nim.queryAccountUidMap||this.nim.wbQueryAccountUidMap;e.call(this.nim,this.channelName,[t.uid])}},d.onUserLeft=function(t){var e=this;this.imInfo.channelId&&(this.logger.log("leave channel from signal"),"p2p"===this.imInfo.sessionMode?(this.controller.uploadDataApi("send"),setTimeout(function(){e.logger.log("超时处理 onUserLeft"),e.resetWhenHangup()},1e3),this.emit("hangup",{channelId:t.channelId||t.cid,account:this.target.account,type:t.type||0})):this.emit("leaveChannel",{channelId:t.channelId||t.cid,account:this.getAccountWithUid(t.uid),type:t.type||0}))},d.onNotifyJoin=function(t){if(this.logger){this.logger.log("join channel from IM");var e=t.accountUidMap,n=this.needQueryAccountMap;this.parseAccountUidMap(e);for(var i in e){var o=i,r=e[i];if(r in n){var s=n[r];s.account=o,delete n[r],this.logger.log("userjoin ----> from IM",t),this.emit("joinChannel",s)}}}},d.onCalleeAck=function(t){if(this.logger.log("收到被叫的通知",t),!this.baseNotCurrentChannelId(t)){var e=t.account,n=this.beCalledInfo||this.callerInfo;this.target.account=e,this.setSessionConfig({signalEndTime:Date.now()}),t.accepted?(this.callAccepted=!0,this.initSession()):(this.logger.log("call Rejected",t),this.packNetcallRecord({type:t.type,channelId:t.channelId,isCaller:!0,target:t.account,recordType:"netcallRejected"}),this.resetWhenHangup(),this.emit("callRejected",{type:n.type,account:e}))}},d.onHangup=function(t){var e=this;this.channelId&&"p2p"===this.sessionMode&&(this.logger.log("on hangup from IM"),this.controller.uploadDataApi("send"),setTimeout(function(){e.logger.log("超时处理 onHangup"),e.resetWhenHangup()},1e3),this.emit("hangup",{channelId:t.channelId,account:t.account,type:0}))},d.onControl=function(t){this.emit("control",t)},d.onCalleeAckSync=function(t){this.emit("callerAckSync",t),this.baseIsCurrentChannelId(t)&&this.resetWhenHangup()},d.baseCreateChannel=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u.tool.verifyOptions(n,"channelName"),n.custom=n.custom||"",this.setSessionConfig({signalStartTime:Date.now()}),this.nim[t](n).then(function(t){return Promise.resolve(t)})["catch"](function(t){return e.setSessionConfig({signalEndTime:Date.now()}),Promise.reject(t)})},d.baseJoinChannel=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.nim[t](n).then(function(t){return e.setSessionConfig({signalEndTime:Date.now()}),e.signalInited=!0,e.sessionMode=t.sessionMode="meeting",e.parseAccountUidMap(t.accountUidMap),t.uid=e.getUidWithAccount(e.nim.account),Promise.resolve(t)})["catch"](function(t){return e.setSessionConfig({signalEndTime:Date.now()}),Promise.reject(t)})},d.format=function(t){return t.rtcServerMap&&(t.rtcServerMap=JSON.parse(t.rtcServerMap),t.rtcServerMap=t.rtcServerMap.webrtcarray||[t.rtcServerMap.webrtc]||t.rtcServerMap),t.wbServerMap&&(t.wbServerMap=JSON.parse(t.wbServerMap),t.wbServerMap=t.wbServerMap.webrtcarray||[t.wbServerMap.webrtc]||t.wbServerMap),t},d.resetWhenHangup=function(){},t.exports=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(7),r=i(o),s=n(17),a=i(s),c=n(16),l=i(c),u=n(135),h=i(u),f=n(61),d=i(f),p=n(106),v=i(p),b=n(20),y=function(t){return new v["default"](t)},g=function(t){function e(n){(0,r["default"])(this,e);var i=(0,a["default"])(this,t.call(this,n));return i.info={},i._init(n),i._reset(),i}return(0,l["default"])(e,t),e.prototype._init=function(t){this.info=Object.assign(this.info,t),this.logger=t.logger||window.console,d["default"].STATS_RTC[d["default"].CURRENT.SDK_TYPE]&&(this.dataApi=y({appkey:this.info.appKey,platform:d["default"].SDK_NAME[d["default"].CURRENT.SDK_TYPE]}))},e.prototype._reset=function(){this.signal&&(this.signal.destroy(),this.signal=null),this.sessionConfig={},this.imInfo={},this.target={},this.userJoinTimeoutId=0,this.remoteNodeStatus={}},e.prototype.resetStatus=function(){this._reset()},e.prototype._startSession=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.imInfo||t;e.uid=+e.uid,e.cid=+e.cid,this.setSessionConfig(e.sessionConfig);var n=e.serverMap||{};e.urlArray=e.serverAddrs||n.webrtcarray||[n.webrtc];var i=void 0;return i=this.signal?Promise.resolve(this.signal):this._initSignal()},e.prototype._initSignal=function(){var t=this;if(this.signal)return Promise.resolve();var e=new h["default"]({logger:this.logger}),n=this.imInfo.urlArray;if(n){var i=n.shift();return i?e.connect({url:i,imInfo:this.imInfo}).then(function(e){return t.signal=e,t._initSignalEvent(),Promise.resolve(e.url)})["catch"](function(e){return t._initSignal()}):Promise.reject("无可用的网关服务器地址, 如果当前应用是WebRTC音视频, 请确保对方打开了WebRTC兼容开关")}},e.prototype._initSignalEvent=function(){var t=this,e=this.signal;e.on("signalTimeout",this.onSignalTimeout.bind(this)),e.on("message",this.onSignalMessage.bind(this)),e.on("signalClosed",function(){t.emit("signalClosed"),t.resetStatus()}),this.signal.on("signalError",function(e){t.emit("signalClosed"),t._stopSignal()})},e.prototype._stopSignal=function(){this.signal&&(this.signal.destroy(),this.signal=null)},e.prototype._stopSession=function(){this._stopSignal(),this._reset()},e.prototype._logout=function(){this.signal&&this.signal.logout()},e.prototype.setAppKey=function(t){t&&(this.info.appKey=t)},e.prototype.setSessionConfig=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.sessionConfig=Object.assign(this.sessionConfig,t)},e.prototype.onSignalMessage=function(t){},e.prototype.onSignalTimeout=function(t){},e.prototype.uploadDataApi=function(t,e){d["default"].STATS_FUN[d["default"].CURRENT.SDK_TYPE]&&this.info.appKey&&("start"===t&&(e.appkey=this.info.appKey),this.dataApi[t]&&this.dataApi[t](e))},e}(b);e["default"]=g,t.exports=e["default"]},,,,,,,,,,,,,,,,function(t,e){"use strict";function n(t){i(t.enable)&&(this.enable=t.enable?1:0),i(t.needBadge)&&(this.needBadge=t.needBadge?1:0),i(t.needPushNick)&&(this.needPushNick=t.needPushNick?1:0),i(t.pushContent)&&(this.pushContent=""+t.pushContent),i(t.custom)&&(this.custom=""+t.custom),i(t.pushPayload)&&(this.pushPayload=""+t.pushPayload),i(t.sound)&&(this.sound=""+t.sound),i(t.webrtcEnable)&&(this.webrtcEnable=t.webrtcEnable?1:0)}e.__esModule=!0,e["default"]=function(t){var e=t.util;return i=e.notundef,n};var i=void 0;t.exports=e["default"]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(7),r=i(o),s=function(){function t(e){(0,r["default"])(this,t),this.all=e||Object.create(null)}return t.prototype.on=function(t,e){(this.all[t]||(this.all[t]=[])).push(e)},t.prototype.off=function(t,e){this.all[t]&&this.all[t].splice(this.all[t].indexOf(e)>>>0,1)},t.prototype.emit=function(t,e){(this.all[t]||[]).map(function(t){t(e)}),(this.all["*"]||[]).map(function(n){n(t,e)})},t}();e["default"]=s,t.exports=e["default"]},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n,i){var o=0;e.forEach(function(e){if(e.visible&&!(o>=n)){if(s(t,e),"fill"===e.mode)return v(t,e.corner[0]);t.drawImage(e.ctx.canvas,e.corner[0].x,e.corner[0].y),n++}}),r(t,i)}function r(t,e){e&&Object.keys(e).map(function(n){var i=(e[n].ctxFlag,e[n].shapesFlag);i.x&&i.y&&l(t,i,e[n].color)})}function s(t,e){var n=e.UID,i=e.ctx,o=e.size,r=e.color,s=e.mode;void 0!==n&&(t.lineWidth=i.lineWidth=o,t.strokeStyle=i.strokeStyle=r),"erase"===s?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="source-over"}function a(t,e){var n=t.canvas,i=document.createElement("canvas").getContext("2d");i.canvas.width=n.width,i.canvas.height=n.height,i.drawImage(n,0,0,n.width,n.height),n.style.width=n.width*e+"px",n.style.height=n.height*e+"px",n.width=n.width*e,n.height=n.height*e,t.lineCap=t.lineJoin="round",t.drawImage(i.canvas,0,0,n.width,n.height)}function c(t){t.clearRect(0,0,t.canvas.width,t.canvas.height)}function l(t,e,n){var i=e.r||1.5;p(t,e,i+2,!0,"#aaa"),p(t,e,i,!0,n)}function u(t,e,n,i){return e.x===i.x&&e.y===i.y?void f(t,e,1,1):(e.c&&(t.strokeStyle=e.c),t.beginPath(),t.moveTo(e.x,e.y),t.quadraticCurveTo(n.x,n.y,i.x,i.y),void t.stroke())}function h(t,e,n){e.c&&(t.strokeStyle=e.c),t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.stroke()}function f(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];o?t.fillRect(e.x,e.y,n,i):t.strokeRect(e.x,e.y,n,i)}function d(t,e,n,i,o){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=e.x,a=e.y,c=n<0?-o:o,l=i<0?-o:o;t.beginPath(),t.moveTo(s+c,a),t.lineTo(s+n-c,a),t.quadraticCurveTo(s+n,a,s+n,a+l),t.lineTo(s+n,a+i-l),t.quadraticCurveTo(s+n,a+i,s+n-c,a+i),t.lineTo(s+c,a+i),t.quadraticCurveTo(s,a+i,s,a+i-l),t.lineTo(s,a+l),t.quadraticCurveTo(s,a,s+c,a),t.stroke(),r&&t.fill()}function p(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments[4];t.save(),t.beginPath(),o&&(t.strokeStyle=o),t.arc(e.x,e.y,n,0,2*Math.PI,!0),t.stroke(),i&&t.fill(),t.restore()}function v(t,e){function n(t){return t===y||(4278190080&t)>>>0<4278190080}var i=e.x,o=e.y,r=t.getImageData(0,0,t.canvas.width,t.canvas.height),s=0,a=1,c=t.strokeStyle,l=parseInt(c.substr(1,2),16),u=parseInt(c.substr(3,2),16),h=parseInt(c.substr(5,2),16),f=(255<<24|h<<16|u<<8|l)>>>0,d=[i,o],p=new ArrayBuffer(r.data.length),v=new Uint8ClampedArray(p);v.set(r.data);var b=new Uint32Array(p),y=b[o*r.width+i];if(y!==f){for(var g=[d],m=void 0,_=r.width-1,w=r.height-1;m=g.pop();){for(var C=m[a]*r.width+m[s],O=m[s],S=m[a];S-- >=0&&n(b[C]);)C-=r.width;C+=r.width,S++;for(var I=!1,T=!1;S++<w&&n(b[C]);)b[C]=f,O>0&&(n(b[C-1])?I||(g.push([O-1,S]),I=!0):I&&(I=!1)),O<_&&(n(b[C+1])?T||(g.push([O+1,S]),T=!0):T&&(T=!1)),C+=r.width}r.data.set(v),t.putImageData(r,0,0)}}e.__esModule=!0;var b=n(7),y=i(b),g=n(17),m=i(g),_=n(16),w=i(_),C=n(205),O=i(C),S=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,y["default"])(this,e);var o=(0,m["default"])(this,t.call(this));if(o.displayCtx&&o.destroy(),o.users={},o.opt=i,o.UID=i.UID||0,o.shapes=[],o.visible=0,o.currMode=null,o.currModeBk=null,o.currColor=i.color,!n)return(0,m["default"])(o);if(!(n instanceof window.HTMLElement))throw new Error("画板容器不是HTMLElement实例");return o.setContainer(n,i),console.log("opt.mode",i.mode),i.mode=i.mode||"free",o.mode("draw:"+i.mode),o}return(0,w["default"])(e,t),e.prototype.setContainer=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(t instanceof window.HTMLElement))throw new Error("画板容器不是HTMLElement实例");this.container&&this.container.remove(),this.container=t,t.style.position="relative",e.width=e.width||t.clientWidth||400,e.height=e.height||t.clientHeight||400,this.opt=Object.assign(this.opt,e),this.width=this.opt.width,this.height=this.opt.height,this.canvas?this.setCanvasSize():this.initCanvas(),t.appendChild(this.displayCanvas),t.appendChild(this.canvas),this.switchEventListener(!0)},e.prototype.initCanvas=function(){var t=document.createElement("canvas");if(this.displayCtx=t.getContext("2d"),t.style.position="relative",t.style.boxSizing="content-box",t.style.backgroundPosition="center",t.style.backgroundRepeat="no-repeat",t.style.backgroundSize="contain",t.style.zIndex=this.opt.zIndex||0,"number"!=typeof this.width)throw new Error("画板宽度不是数字");if("number"!=typeof this.height)throw new Error("画板高度不是数字");this.displayCtx.lineCap=this.displayCtx.lineJoin="round",this.setCanvasSize();var e=this.addUser(this.UID);this.displayCanvas=t,this.canvas=e.ctx.canvas,this.dispatcher=this.dispatcher.bind(this)},e.prototype.setCanvasSize=function(){this.displayCtx.canvas.width=this.width,this.displayCtx.canvas.height=this.height},e.prototype.enableDraw=function(t){console.log("enableDraw",t),this.isEnable=!!t,this.switchEventListener(!!t),t?this.currModeBk?(this.currModeBk&&this.mode(this.currModeBk),this.currModeBk=""):this.currMode&&this.setCursor(this.currMode.replace("draw:","")):(this.currModeBk="",/flag/.test(this.currMode)&&(this.currModeBk=this.currMode,this.clearFlag(),this.emit("action",{op:"flagend"})),this.setCursor("not-allowed"))},e.prototype.switchEventListener=function(t){var e=t?"add":"remove",n=this.users[this.UID].ctx.canvas,i=[n,this.displayCtx.canvas];n.style.visibility=t?"visible":"hidden";var o=this.dispatcher;i.forEach(function(t){t[e+"EventListener"]("mousedown",o),t[e+"EventListener"]("mousemove",o),t[e+"EventListener"]("touchmove",o),t[e+"EventListener"]("touchstart",o)}),document[e+"EventListener"]("mouseup",o),document[e+"EventListener"]("touchend",o)},e.prototype.setCursor=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not-allowed";console.log("setCursor",e);var n=[this.users[this.UID].ctxFree.canvas,this.users[this.UID].ctxFlag.canvas,this.displayCtx.canvas];e=/(flag|crosshair|not-allowed)/.test(e)?e:"crosshair",this.cursor=e||this.cursor,"flag"===this.cursor&&(this.cursor="none"),n.forEach(function(e){e.style.cursor=t.cursor})},e.prototype.mode=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=this.users[e];if(!t)return n.mode;if("string"!=typeof t)throw new Error("操作模式不是字符串");var i=t.split(":");if(n.mode=i[0],n.type=i[1]||"free",n.type="flagend"===n.type?"free":n.type,"flag"===n.type?(n.isFlag=!0,n.ctx=n.ctxFlag,n.shapesFlag={r:3.5}):n.isFlag===!0&&(n.isFlag=!1,this.clearFlag(e)),n.currMode=t,e===this.UID){if(this.currMode=t,!this.isEnable)return void(this.currModeBk=t);this.setCursor(n.type),this.emit("action",{UID:e,op:"mode",value:t})}},e.prototype.clearFlag=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.UID,e=this.users[t];e&&(this.emit("action",{UID:t,op:"flagend"}),e.shapesFlag={r:3.5},e.ctx=e.ctxFree,c(e.ctxFlag),this._clear(),o(this.displayCtx,this.shapes,++this.visible,this.users))},e.prototype.size=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=this.users[e];if(!t)return n.size;if("number"!=typeof t)throw new Error("Type Error: size");n.size=t,this.emit("action",{UID:e,op:"size",value:t})},e.prototype.color=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=this.users[e];return t?(n.color=t,e===this.UID&&(this.currColor=t),void this.emit("action",{UID:e,op:"color",value:t})):n.color},e.prototype.mousedown=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=void 0,i=this.users[e],o=i.start,r=i.oldMid,a=i.end;i.isMouseDown=!0;var c=i.ctx;switch("free"===i.type?c.canvas.style.visibility="hidden":c.canvas.style.visibility="visible",s(this.displayCtx,i),i.mode){case"draw":case"erase":switch(n=new T(i.mode,i.type,i.size,i.color,new I(t.x,t.y)),i.activeShape=n,this.shapes.push(n),i.shapes.push(this.shapes.length-1),i.type){case"free":I.set(o,t.x,t.y),I.set(r,o.x,o.y),I.set(a,o.x,o.y);break;case"flag":I.set(o,t.x,t.y);break;default:I.set(o,t.x,t.y)}break;case"fill":n=new T(i.mode,i.type,i.size,i.color,new I(t.x,t.y)),this.shapes.push(n),i.shapes.push(this.shapes.length-1),v(this.displayCtx,t);break;case"select":}"select"!==i.mode&&(i.available=++i.visible,this.visible++),this.emit("action",{UID:e,op:"mousedown",value:t})},e.prototype.mousemove=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=this.users[e];if((e!==this.UID||this.isEnable)&&(n.isMouseDown||n.isFlag)){var i=n.start,r=n.oldMid,a=n.end,l=n.ctx,v=this.displayCtx;if(n.isFlag)return c(l),n.shapesFlag=Object.assign(n.shapesFlag,t),this._clear(),o(v,this.shapes,++this.visible,this.users),void this.emit("action",{UID:e,op:"mousemove",value:t});switch(n.mode){case"draw":case"erase":switch(s(v,n),n.type){case"free":var b=new I((a.x+t.x)/2,(a.y+t.y)/2);u(l,r,a,b),u(v,r,a,b),I.set(r,b.x,b.y),I.set(a,t.x,t.y);break;case"line":I.set(a,t.x,t.y),l.clearRect(0,0,l.canvas.width,l.canvas.height),h(l,i,a);break;case"rect":I.set(a,t.x,t.y),l.clearRect(0,0,l.canvas.width,l.canvas.height),f(l,i,a.x-i.x,a.y-i.y);break;case"roundRect":I.set(a,t.x,t.y),l.clearRect(0,0,l.canvas.width,l.canvas.height),d(l,i,a.x-i.x,a.y-i.y,30);break;case"circle":I.set(a,t.x,t.y),l.clearRect(0,0,l.canvas.width,l.canvas.height),p(l,i,Math.abs(t.x-i.x))}var y=n.activeShape.corner;if(y)if("circle"===n.type){var g=Math.abs(t.x-i.x);y[0].x=i.x-g,y[0].y=i.y-g,y[1].x=i.x+g,y[1].y=i.y+g}else y[0].x=Math.min(a.x,y[0].x),y[0].y=Math.min(a.y,y[0].y),y[1].x=Math.max(a.x,y[1].x),y[1].y=Math.max(a.y,y[1].y);break;case"fill":break;case"select":break;case"image":}this.emit("action",{UID:e,op:"mousemove",value:t})}},e.prototype.mouseup=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID,n=this.users[e];if(n.isMouseDown){n.isMouseDown=!1;var i=n.start,o=n.oldMid,r=n.end,a=n.ctx,c=this.displayCtx;switch(n.mode){case"draw":case"erase":switch(s(c,n),n.type){case"free":var l=new I((r.x+t.x)/2,(r.y+t.y)/2);u(a,o,r,l),u(c,o,r,l),I.set(o,l.x,l.y),I.set(r,t.x,t.y);break;case"line":I.set(r,t.x,t.y),h(a,i,r);break;case"rect":I.set(r,t.x,t.y),f(a,i,r.x-i.x,r.y-i.y);break;case"roundRect":I.set(r,t.x,t.y),d(a,i,r.x-i.x,r.y-i.y,30);break;case"circle":I.set(r,t.x,t.y),p(a,i,Math.abs(t.x-i.x))}var v=n.activeShape.corner,b=n.activeShape.ctx;v[0].x-=this.size(),v[0].y-=this.size(),v[1].x+=this.size(),v[1].y+=this.size(),b.canvas.width=Math.ceil(v[1].x-v[0].x),b.canvas.height=Math.ceil(v[1].y-v[0].y),b.lineCap=b.lineJoin=n.ctx.lineCap,b.lineWidth=n.ctx.lineWidth;var y=a.getImageData(v[0].x,v[0].y,b.canvas.width,b.canvas.height);b.putImageData(y,0,0),"free"!==n.type&&c.drawImage(b.canvas,v[0].x,v[0].y),a.clearRect(0,0,this.displayCtx.canvas.width,this.displayCtx.canvas.height);break;case"fill":break;case"select":}this.emit("action",{UID:e,op:"mouseup",value:t})}},e.prototype.undo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.UID,e=this.users[t];if(0!==e.visible){var n=e.shapes.pop();this.shapes[n].visible=!1,e.recycle.push(n),--e.visible,this._clear(),o(this.displayCtx,this.shapes,--this.visible,this.users),this.emit("action",{UID:t,op:"undo",value:t})}},e.prototype.image=function(t){if(t){var e=this,n=this.displayCtx.canvas,i=new Image,o=void 0===this.opt.backgroundUrl?"http://dev.netease.im/images/logo2.png":this.opt.backgroundUrl;i.onload=function(){e.container.classList.remove("canvas-loading"),n.style.backgroundSize="contain",n.style.backgroundImage="url("+t+")"},this.container.classList.add("canvas-loading"),n.style.backgroundSize="auto",n.style.backgroundImage="url("+o+")",i.src=t}},e.prototype.clearImage=function(){this.displayCtx.canvas.style.backgroundImage=""},e.prototype.redo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.UID,e=this.users[t];if(e.visible!==e.available){var n=e.recycle.pop();this.shapes[n].visible=!0,e.shapes.push(n),++e.visible,this._clear(),o(this.displayCtx,this.shapes,++this.visible,this.users),this.emit("action",{UID:t,op:"redo",value:t})}},e.prototype.clear=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.UID;if(this._clear(),t&&this.users[t]){var i=this.users[t];return i.isMouseDown=!1,i.shapes.forEach(function(t){e.shapes[t]&&(e.shapes[t].visible=!1,e.visible--)}),i.shapes=[],i.shapesFlag={r:3.5},i.recycle=[],i.available=0,i.visible=0,this._clear(),void o(this.displayCtx,this.shapes,this.visible,this.users)}this.shapes=[],this.visible=0;for(var r in this.users){var s=this.users[r];s.shapes=[],s.shapesFlag={r:3.5},s.recycle=[],s.available=0,s.visible=0,s.isMouseDown=!1}this.emit("action",{UID:n,op:"clear",value:null})},e.prototype._clear=function(){this.displayCtx.clearRect(0,0,this.width,this.height);for(var t in this.users){var e=this.users[t];e.ctx.clearRect(0,0,this.width,this.height)}},e.prototype.act=function(t){var e=t.UID,n=t.op,i=t.value,o=this.users[e];o||(this.users[e]=this.addUser(e)),this[n]&&this[n](i,e)},e.prototype.resize=function(t){if(t=parseInt(t),isNaN(t)||t<=0)throw new Error("白板宽度应是大于0的数字");var e=t/this.width,n=this.height*e;a(this.displayCtx,e);for(var i in this.users)a(this.users[i].ctx,e);this.shapes.forEach(function(t){a(t.ctx,e),t.corner[0].x*=e,t.corner[0].y*=e,t.corner[1].x*=e,t.corner[1].y*=e}),this.width=t,this.height=n},e.prototype.addUser=function(t){if(this.users[t])return this.users[t];var e=new x(t),n=e.ctx.canvas,i=this.displayCtx.canvas;return n.style.position="absolute",n.style.boxSizing="content-box",n.style.top=i.clientTop+"px",n.style.left=i.clientLeft+"px",n.style.zIndex=i.style.zIndex+1,n.style.cursor="crosshair",n.style.width=this.width+"px",n.style.height=this.height+"px",n.width=this.width,n.height=this.height,e.ctx.lineCap=e.ctx.lineJoin="round",this.users[t]=e,this.users[t]},e.prototype.removeUser=function(t){t&&this.clearFlag(t)&&this._removeUser(t)},e.prototype._removeUser=function(t){var e=this.users[t];if(e){try{this.container.removeChild(e.ctxFree.canvas),this.container.removeChild(e.ctxFlag.canvas)}catch(n){}this.users[t]=null,delete this.users[t]}},e.prototype.destroy=function(){var t=this;Object.keys(this.users).map(function(e){t._removeUser(e),delete t.users[e]}),this.users[this.UID]&&this.switchEventListener(!1),this.container.removeChild(this.displayCtx.canvas),this.displayCtx=null,this.shapes=[],this.visible=0},e.prototype.dispatcher=function(t){if(t.preventDefault(),t=t.originalEvent?t.originalEvent:t,this.displayCtx){var e=this.displayCtx.canvas.getBoundingClientRect(),n=void 0,i=void 0;t.touches&&1===t.touches.length?(n=t.touches[0].clientX,i=t.touches[0].clientY):t.changedTouches&&1===t.changedTouches.length?(n=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY):(n=t.clientX,i=t.clientY),n||0===n||(n=0),i||0===i||(i=0);var o=new I(n-e.left,i-e.top),r=t.type;"touchstart"===r&&(r="mousedown"),"touchmove"===r&&(r="mousemove"),"touchend"===r&&(r="mouseup"),this[r](o)}},e}(O["default"]);e["default"]=S;var I=function(){function t(e,n){(0,y["default"])(this,t),this.x=e||0,this.y=n||0}return t.prototype.copy=function(){return new t(this.x,this.y)},t.set=function(t,e,n){t.x=e,t.y=n},t}(),T=function A(t,e,n,i,o){(0,y["default"])(this,A),this.visible=!0,this.ctx=document.createElement("canvas").getContext("2d"),this.type=e,this.mode=t,this.color=i,this.size=n,this.corner=[o.copy(),o.copy()],this.transform=[],this.path=[],this.zIndex=0},x=function E(t){(0,y["default"])(this,E),this.UID=t,this.ctxFree=document.createElement("canvas").getContext("2d"),this.ctxFlag=document.createElement("canvas").getContext("2d"),this.ctx=this.ctxFree,this.shapes=[],this.shapesFlag={},this.recycle=[],this.mode="draw",this.type="free",this.size=4,this.color="#000",this.isMouseDown=!1,this.start=new I(0,0),this.oldMid=new I(0,0),this.end=new I(0,0),this.visible=0,this.available=0,this.activeShape={}};t.exports=e["default"]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(7),r=i(o),s=n(17),a=i(s),c=n(16),l=i(c),u=n(20),h=i(u),f=n(206),d=i(f),p="#f5455e",v="#238efa",b={10:"jpg",11:"png",0:"unknown"},y={1:1,2:1,3:1,12:1},g={8:1,9:1,10:1,11:1},m=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r["default"])(this,e);var o=(0,a["default"])(this,t.call(this));return o.resetStatus(),o.nim=i.nim||{},o.debug=i.debug||!1,o.limit=i.limit||80,o.draw=new d["default"](n,i),o.draw.size(4),o.formatColor(i.color,10)===-1&&(console.warn("whiteboard::setColor:设置颜色失败:不合法的色值,采用默认红色值"),i.color=p),o.draw.color(i.color),o.draw.on("action",o.transform.bind(o)),o.timer=setInterval(function(){Object.keys(o.dataQue).map(function(t){if(o.dataQue[t]){var e=o.dataQue[t];o.debug&&(e+="5:"+o.count+",0;"),o.emit("action",{key:t,data:e}),o.dataQue[t]="",o.count++}})},o.limit),o}return(0,l["default"])(e,t),e.prototype.destroy=function(){this.resetStatus(),this.timer&&clearInterval(this.timer),this.timer=null,this.draw&&this.draw.destroy(),this.draw=null},e.prototype.resetStatus=function(){this.fileMap={},this.datas={},this.dataQue={},this.count=0},e.prototype.appendDatas=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"draw";this.datas[t]||(this.datas[t]={}),console.log("appendDatas",e,n),"file"===n?this.datas[t][n]=e:this.datas[t][n]=(this.datas[t][n]||"")+e},e.prototype.sendDatas=function(t){var e=this;arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;console.log("sendDatas start",this.datas),Object.keys(this.datas).map(function(n){var i=e.datas[n];Object.keys(i).map(function(o){i[o]&&(console.log("sendDatas",i,o),e.emit("action",{key:t,data:{uid:n,data:i[o]}}))})})},e.prototype.clearDatas=function(){this.datas={}},e.prototype.setContainer=function(t){this.draw.setContainer(t)},e.prototype.enableDraw=function(t){this.draw.enableDraw(t)},e.prototype.setColor=function(t,e){t&&(/^#/.test(t)||(t="#"+t),this.formatColor(t,10)===-1?console.error("whiteboard::setColor:设置颜色失败:不合法的色值"):this.draw.color(t,e))},e.prototype.setStyle=function(t){this.draw.setStyle(t)},e.prototype.undo=function(){this.draw.undo()},e.prototype.redo=function(){this.draw.redo()},e.prototype.clear=function(){this.draw.clear()},e.prototype.setDrawMode=function(t,e){this.draw.mode("draw:"+t,e)},e.prototype.image=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.draw.UID,n=t.url,i=t.docId,o=t.pageCount,r=t.currentPage;n?this.draw.image(n,e):this._image(t,e),e===this.draw.UID&&this.transform({UID:this.draw.UID,op:"file",value:{docId:i,pageCount:o,currentPage:r}})},e.prototype._image=function(t,e){console.log("_image",t);var n=t.docId,i=t.currentPage;if(!n||i-0===0)return void this.clearImage(e);var o=this.nim,r=this.fileMap[n];if(r||o){if(console.log("file!!!",r),r){var s=r.prefix+"_"+r.type+"_"+i+"."+b[r.transType];return void this.draw.image(s,e)}var a=this;o.getFile({docId:n,success:function(i){a.fileMap[n]=i,a._image(t,e)},error:function(t){console.error("getFile error",t)}})}},e.prototype.clearImage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.draw.UID;this.draw.clearImage(),t===this.draw.UID&&(this.datas[t]&&(this.datas[t].file=""),this.transform({UID:this.draw.UID,op:"file",value:{docId:""}}))},e.prototype.resize=function(t){this.draw.resize(t)},e.prototype.act=function(t){var e=this,n=t.UID,i=t.data;if(n!==this.draw.UID){this.draw.users[n]||(this.draw.addUser(n),this.draw.users[n].color=v);var o=i.split(";"),r=this.draw.width,s=this.draw.height,a=i.match(/\d+/);g[a&&a[0]]||this.appendDatas(n,i),o.forEach(function(t){if(t){var i=t.split(":"),o=i[0],a=i.length>1?i[1].split(","):[],c={};switch(o){case"1":c.op="mousedown",c.value={x:Math.ceil(parseFloat(a[0])*r),y:Math.ceil(parseFloat(a[1])*s)};break;case"2":c.op="mousemove",e.setColor(e.formatColor(a[2]),n),c.value={x:Math.ceil(parseFloat(a[0])*r),y:Math.ceil(parseFloat(a[1])*s)};break;case"3":c.op="mouseup",c.value={x:Math.ceil(parseFloat(a[0])*r),y:Math.ceil(parseFloat(a[1])*s)};break;case"4":c.op="undo",c.value=n;break;case"5":return;case"6":c.op="clear",e.clearDatas(),e.data+="7:0,0;";break;case"7":c.op="clear",c.value=n;break;case"8":return console.log("收到同步请求",n),void e.sendDatas(n);case"9":console.log("同步数据",c.value);break;case"10":c.value=n,c.op="syncResponse",e.draw.clear(),e.draw.clearImage();break;case"11":break;case"12":c.op="mousemove",e.draw.color(e.formatColor(a[2]),n),c.value={x:Math.ceil(parseFloat(a[0])*r),y:Math.ceil(parseFloat(a[1])*s)},e.setDrawMode("flag",n);break;case"13":e.setDrawMode("flagend",n);break;case"14":e.image({docId:a[0],currentPage:a[1],pageCount:a[2]},n);break;default:return}c.UID=n,e.draw.act(c)}})}},e.prototype.removeUser=function(t){t&&this.draw.removeUser(t)},e.prototype.transform=function(t){if(t.UID===this.draw.UID){var e=t.target||0,n=this.draw.users[t.UID],i="",o=[],r=this.draw.width,s=this.draw.height,a=void 0,c=void 0;switch(t.op){case"mousedown":i="1",a=t.value.x/r,c=t.value.y/s,o.push(a.toFixed(2),c.toFixed(2));break;case"mousemove":i="2",a=t.value.x/r,c=t.value.y/s,o.push(a.toFixed(2),c.toFixed(2));break;case"mouseup":i="3",a=t.value.x/r,c=t.value.y/s,o.push(a.toFixed(2),c.toFixed(2));break;case"undo":i="4",o.push(0,0);break;case"color":return void(this.color=parseInt(t.value.substring(1),16));case"clear":i="6",o.push(0,0);break;case"syncRequest":i="8",o.push(0,0);break;case"syncBegin":i="10",o.push(0,0);break;case"syncResponse":i="11",o.push(0,0);break;case"flag":i="12",a=t.value.x/r,c=t.value.y/s,o.push(a.toFixed(2),c.toFixed(2));break;case"flagend":i="13";break;case"file":i="14",o.push(t.value.docId,t.value.currentPage,t.value.pageCount,"1");break;default:return}y[i]&&(i=n.isFlag?"12":i,o.push(this.formatColor(this.draw.currColor,10)));var l=i+":"+o.join(",")+";";this.dataQue[e]=this.dataQue[e]||"",this.dataQue[e]+=l,"12"!==i&&("6"===i?this.clearDatas():"14"===i?this.appendDatas(this.draw.UID,this.dataQue[e],"file"):y[i]&&this.appendDatas(this.draw.UID,this.dataQue[e]))}},e.prototype.formatColor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16;if(!t)return-1;var n="";return 16===e?(t=+t,t<0?(n=this.hex2rgb(t),console.log("hex2rgb",t,n),n):(n=t.toString(16),n.length<3&&(n=("000"+n).slice(-3)),n.length>3&&n.length<6&&(n=("000"+n).slice(-6)),n="#"+n,console.log("formatColor 16",t,n),n)):10===e?(n=t.replace(/#/gi,""),n=parseInt("0x"+n),console.log("formatColor 10",t,n),isNaN(n)?-1:n):void 0},e.prototype.hex2rgb=function(t){var e=t>>24&255,n=t>>16&255,i=t>>8&255;return"#"+("0"+e).slice(-2)+("0"+n).slice(-2)+("0"+i).slice(-2)},e.prototype.syncBegin=function(){console.log("同步准备清空，主播重新登录聊天室后，广播该协议给其他人，其他人收到后进行本地清空"),this.transform({UID:this.draw.UID,op:"syncBegin"}),this.clearImage()},e.prototype.syncRequest=function(t){console.log("同步请求，非主播重新登录后发请求给主播"),this.transform({UID:this.draw.UID,op:"syncRequest",target:t})},e.prototype.syncResponse=function(){this.transform({UID:this.draw.UID,op:"syncResponse"})},e}(h["default"]);e["default"]=m,t.exports=e["default"]},function(t,e){"use strict";e.__esModule=!0,e["default"]={getAccount:function(){return this.baseGetAccount()},getUid:function(){return this.baseGetUid()},isCurrentChannelId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.baseIsCurrentChannelId(t)},notCurrentChannelId:function(t){return!this.isCurrentChannelId(t)},startSession:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.sessionStarted?Promise.resolve():(this.sessionStarted=!0,t.wssArr&&(this.imInfo.serverAddrs=t.wssArr.constructor===Array?t.wssArr:[t.wssArr]),this.baseStartSession(),this.controller.startSession(this.imInfo))},stopSession:function(){return this.resetWhenHangup(),Promise.resolve()},leaveChannel:function(){this.stopSession()},changeRoleToPlayer:function(){
return 0===this.imInfo.role?Promise.resolve({role:"player"}):(this.controller.enableDraw(!0),this.imInfo.role=0,Promise.resolve({role:"player"}))},changeRoleToAudience:function(){var t=this;return 1===this.imInfo.role?Promise.resolve({role:"audience"}):(this.controller.enableDraw(!1),new Promise(function(e,n){setTimeout(function(){t.imInfo.role=1,e({role:"audience"})},1e3)}))},undo:function(){this.controller.undo()},redo:function(){this.controller.redo()},setContainer:function(t){this.controller.setContainer(t)},image:function(t,e){var n=this.getUidWithAccount(e||this.imInfo.account);this.controller.image(t,n)},clearImage:function(){this.controller.clearImage()},clear:function(){this.controller.clear()},resize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controller.resize(t)},sendCustomData:function(t){this.controller.sendCustomData(t)},send:function(t){this.controller.sendCustomData(t)},setDrawMode:function(t){this.controller.setDrawMode(t)},setColor:function(t){this.controller.setColor(t)},setStyle:function(t){this.controller.setStyle(t)},syncBegin:function(){this.controller.syncBegin()},syncRequest:function(t){if(!t)throw Error("同步请求目标账号缺失");var e=this.getUidWithAccount(t);if(!e)throw Error("syncRequest 同步请求目标账号不正确");this.controller.syncRequest(e)}},t.exports=e["default"]},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(7),r=i(o),s=n(17),a=i(s),c=n(16),l=i(c),u=n(146),h=i(u),f=n(307),d=i(f),p=n(119),v=n(49),b=n(40),y=3,g=null,m=function(t){function e(n){(0,r["default"])(this,e);var i=(0,a["default"])(this,t.call(this,n));return i.logger=n.logger||{},i.resetStatus(),i}return(0,l["default"])(e,t),e}(h["default"]);e["default"]=m;var _=m.prototype;_.resetStatus=function(){this.wbAdapter&&(this.wbAdapter.destroy(),this.wbAdapter=null),this.nodeTimer&&(clearInterval(this.nodeTimer),this.nodeTimer=null),this.reConnectCount=0,this.recv_bytes=0,this.send_bytes=0},_.startSession=function(t){var e=this;return this.imInfo=t||this.imInfo,this.connect().then(function(){e.initWbAdapter(),e.enableDraw(0===e.imInfo.role||"p2p"===e.imInfo.sessionMode)})},_.connect=function(){var t=this;return this._startSession().then(function(e){return g=e,t.reConnectCount=0,new Promise(function(e,n){t.wbLogin(),t.once("LoginSuccess",function(n){t.logger.log("once LoginSuccess-->",n),e(g)}),t.once("LoginFailed",function(e){t.logger.log("once LoginFailed-->",e),n(e)})})})},_.destroy=function(){this.stopSession()},_.stopSession=function(){return this.wbLogout(),this._stopSession(),this.resetStatus(),Promise.resolve()},_.setSessionConfig=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};b.tool.merge(this.sessionConfig,t)},_.initWbAdapter=function(){!this.wbAdapter&&this.info.container&&(this.wbAdapter=new d["default"](this.info.container,{nim:this.info.client.nim,UID:this.imInfo.uid,backgroundUrl:this.sessionConfig.backgroundUrl||"",color:this.sessionConfig.color,width:+this.sessionConfig.width,height:+this.sessionConfig.height,mode:this.sessionConfig.mode||"free",limit:60,debug:this.info.debug}),this.wbAdapter.on("action",this.onWbAdapterData.bind(this)))},_.setContainer=function(t){t=b.element.n2node(t),this.info.container=t,this.wbAdapter?this.wbAdapter.setContainer(t):this.initWbAdapter()},_.enableDraw=function(t){this.wbAdapter&&this.wbAdapter.enableDraw(t)},_.onWbAdapterData=function(t,e){var n=t.key,i=void 0===n?0:n,o=t.data;if(i=+i,o&&(0!==i||0===this.imInfo.role)){this.sendStats(o),i&&o.uid&&(o.account=this.info.client.getAccountWithUid(o.uid),o="9:"+o.account+",1;"+o.data);var r={data:o};"p2p"===this.imInfo.sessionMode&&(r.dst_client_id=this.target&&this.target.uid||0),i-0&&(r.dst_client_id=+i);var s=r.dst_client_id?p.serializeWb.gateWay.toUser:p.serializeWb.gateWay.broadcast;this.sendMsg(s,r)}},_.wbLogin=function(){var t={token:this.imInfo.cid,client_type:2,client_net:2,client_os:6,client_support_record:~~this.sessionConfig.record};this.sendMsg(p.serializeWb.gateWay.login,t)},_.wbLogout=function(){var t=Date.now(),e={timestamp:t,recv_bytes:this.recv_bytes,send_bytes:this.send_bytes};this.sendMsg(p.serializeWb.gateWay.logout,e)},_.sendMsg=function(t,e){var n={type:t,uid:+this.imInfo.uid,cid:+this.imInfo.cid,version:31,content:{params:e}};this.signal&&this.signal.send(n)},_.onSignalMessage=function(t){if(t&&t.cid&&t.uid&&(t.cid=+t.cid,t.uid=+t.uid),t.cid!==this.imInfo.cid)return console.error("websocket message not belong to this session");var e=p.unserializeWb.gateWay[t.type];this["on"+e]&&this["on"+e](t)},_.onloginAck=function(t){var e=this,n=t.content.params.auth_result-0;return 200!==n?(this.logger.error("服务器验证不通过, 断开连接"),void this.emit("LoginFailed",{code:n,error:"服务器验证不通过, 断开连接"})):(this.logger.log("白板服务器登录成功",t),this.emit("LoginSuccess"),void("p2p"===this.imInfo.sessionMode&&(this.logger.log("45s之内等待对方加入"),this.userJoinTimeoutId=setTimeout(function(){e.userJoinTimeoutId&&0===Object.keys(e.remoteNodeStatus).length&&e.emit("error",{error:"点对点对方登录超时, 断开连接"})},45e3))))},_.onjoin=function(t){this.logger.log(t);var e=t.content&&t.content.params&&t.content.params.client_id;this.startNodeMonitor(e),"p2p"===this.imInfo.sessionMode&&(this.target={uid:e},this.initWbAdapter(),this.userJoinTimeoutId&&clearTimeout(this.userJoinTimeoutId),this.userJoinTimeoutId=0),this.emit("userJoined",{uid:e,cid:t.cid})},_.onkeep_alive_node=function(t){var e=t.uid,n=this.remoteNodeStatus;n[e]=n[e]||{now:Date.now(),total:45},n[e].now=Date.now(),n[e].total=45},_.onlogout=function(t){this.logger.log("onlogout",t),this.wbAdapter&&this.wbAdapter.removeUser(t.uid),this.emit("leaveChannel",{uid:t.uid,channelId:t.cid}),delete this.remoteNodeStatus[t.uid]},_.ontoUser=function(t){this.onData(t)},_.onbroadcast=function(t){this.onData(t)},_.onData=function(t){var e=t.content&&t.content.params&&t.content.params.data,n=t.uid;this.receiveStats(e);var i=void 0;try{i=JSON.parse(e||null)}catch(o){i=e}return this.onkeep_alive_node({uid:n}),this.info.isCustom?void this.emit("data",{uid:n,data:i}):i.constructor===Object?void(i.isCustom&&this.emit("customData",{UID:t.uid,data:i.data})):(this.wbAdapter&&this.wbAdapter.act({UID:t.uid,data:i}),this.remoteNodeStatus[t.uid].now=Date.now(),void(this.remoteNodeStatus[t.uid].total=45))},_.startNodeMonitor=function(t){var e=this,n=this.remoteNodeStatus;n[t]=n[t]||{now:Date.now(),total:45},n[t].now=Date.now(),this.nodeTimer||(this.nodeTimer=setInterval(function(){var i=Date.now();Object.keys(n).map(function(o){return i-n[o].now>5e4||n[o].total<=0?(e.logger.warn("节点45s超时离开:",o),e.emit("leaveChannel",{uid:o,type:v.constantBB.HANGUP_TYPE_TIMEOUT,channelId:e.imInfo.cid}),delete e.remoteNodeStatus[t],void delete n[o]):i-n[o].now>5e3?void(n[o].total-=5):void 0})},5e3))},_.onSignalTimeout=function(){var t=this;return this.emit("disconnected"),this.reConnectCount>=y?void this.emit("signalClosed"):(this.reConnectCount++,this.emit("willReconnect",this.reConnectCount),this.logger.log("3s后尝试第"+this.reConnectCount+"次重连服务器"),this._stopSignal(),void setTimeout(function(){t.imInfo&&t.imInfo.serverAddrs&&(t.logger.log("开始第"+t.reConnectCount+"次重连服务器"),g&&t.imInfo.serverAddrs.unshift(g),t.connect().then(function(){t.emit("connected",t.reConnectCount)})["catch"](function(e){t.logger.error("reconnect error",e),t.onSignalTimeout()}))},3e3))},_.setDrawMode=function(t){this.wbAdapter&&this.wbAdapter.setDrawMode(t)},_.setColor=function(t){this.wbAdapter&&this.wbAdapter.setColor(t)},_.setStyle=function(t){this.wbAdapter&&this.wbAdapter.setStyle(t)},_.undo=function(){0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.undo()},_.redo=function(){0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.redo()},_.clear=function(){0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.clear()},_.image=function(t,e){0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.image(t,e)},_.clearImage=function(){0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.clearImage()},_.resize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};0===this.imInfo.role&&this.wbAdapter&&this.wbAdapter.resize(t.width)},_.sendCustomData=function(t){0===this.imInfo.role&&this.onWbAdapterData({key:0,data:t})},_.sendStats=function(t){this.send_bytes+=t.length},_.receiveStats=function(t){this.recv_bytes+=t.length},_.syncBegin=function(){this.wbAdapter&&this.wbAdapter.syncBegin()},_.syncRequest=function(t){this.wbAdapter&&this.wbAdapter.syncRequest(t)},_.syncResponse=function(){this.wbAdapter&&this.wbAdapter.syncResponse()},t.exports=e["default"]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i=n(162),o={};o.install=function(t){var e=t.fn,n=t.util,o=i({util:n});e.initWhiteBoard=function(t){return n.verifyOptions(t,"type accounts","wb::initWhiteBoard"),t.pushContent="",t.custom="",t.pushConfig||(t.pushConfig={}),t.pushConfig.webrtcEnable=t.webrtcEnable,t.pushConfig=new o(t.pushConfig),this.cbAndSendCmd("initWhiteBoard",t)},e.wbKeepCalling=function(t){return n.verifyOptions(t,"type accounts channelId","wb::wbKeepCalling"),this.cbAndSendCmd("wbKeepCalling",t)},e.wbCalleeAck=function(t){return n.verifyOptions(t,"account channelId type accepted","wb::wbCalleeAck"),this.cbAndSendCmd("wbCalleeAck",t)},e.wbHangup=function(t){return n.verifyOptions(t,"channelId","wb::wbHangup"),this.cbAndSendCmd("wbHangup",t)},e.wbControl=function(t){return n.verifyOptions(t,"channelId type","wb::wbControl"),this.cbAndSendCmd("wbControl",t)},e.wbCreateChannel=function(t){return this.cbAndSendCmd("wbCreateChannel",t)},e.wbJoinChannel=function(t){return n.verifyOptions(t,"channelName","wb::wbJoinChannel"),n.verifyBooleanWithDefault(t,"liveEnable",!1,"","wb::wbJoinChannel"),n.verifyBooleanWithDefault(t,"webrtcEnable",!1,"","wb::wbJoinChannel"),this.cbAndSendCmd("wbJoinChannel",{channelName:t.channelName,liveOption:{liveEnable:t.liveEnable?1:0,webrtcEnable:t.webrtcEnable?1:0}})},e.wbQueryAccountUidMap=function(t,e){return this.cbAndSendCmd("wbQueryAccountUidMap",{channelName:t,uids:e})}},t.exports=o},function(t,e){"use strict";var n={};n.install=function(t){var e=t.Protocol.fn;e.processDatatun=function(t){switch(t.cmd){case"initWhiteBoard":this.onWbInit(t);break;case"wbBeCalled":this.onWbBeCalled(t);break;case"wbKeepCalling":this.onWbKeepCalling(t);break;case"wbCalleeAck":break;case"wbNotifyCalleeAck":this.onWbNotifyCalleeAck(t);break;case"wbHangup":break;case"wbNotifyHangup":this.onWbNotifyHangup(t);break;case"wbNotifyControl":this.onWbControl(t);break;case"wbNotifyCalleeAckSync":this.onWbNotifyCalleeAckSync(t);break;case"wbNotifyRecord":break;case"wbCreateChannel":break;case"wbJoinChannel":this.wbJoinChannel(t);break;case"wbNotifyJoin":this.onWbNotifyJoin(t)}},e.onWbInit=function(t){if(!t.error){var e=t.obj.type;t.obj=t.content,t.obj.type=e,t.obj.accounts=t.obj.keepCallingAccounts,this.setCurrentWhiteBoard(t.obj.channelId),this.wbKeepCalling(t)}},e.setCurrentWhiteBoard=function(t){this.currentWhiteBoardChannelId=t},e.onWbKeepCalling=function(t){t.error||t.content.accounts.length&&this.wbKeepCalling(t)},e.wbKeepCalling=function(t){var e=this,n=t.obj,i=n.type,o=n.accounts,r=n.channelId;o&&o.length&&setTimeout(function(){e.currentWhiteBoardChannelId&&e.currentWhiteBoardChannelId===r&&e.api.wbKeepCalling({type:i,accounts:o,channelId:r})["catch"](function(){})},3e3)},e.onWbBeCalled=function(t){t.error||this.emitAPI({type:"wbBeCalled",obj:t.content})},e.onWbNotifyCalleeAck=function(t){t.error||this.emitAPI({type:"wbNotifyCalleeAck",obj:t.content})},e.onWbNotifyHangup=function(t){t.error||this.emitAPI({type:"wbNotifyHangup",obj:t.content})},e.onWbControl=function(t){t.error||this.emitAPI({type:"wbControl",obj:t.content})},e.onWbNotifyCalleeAckSync=function(t){t.error||this.emitAPI({type:"wbNotifyCalleeAckSync",obj:t.content})},e.onWbNotifyJoin=function(t){t.error||this.emitAPI({type:"wbNotifyJoin",obj:t.content})},e.wbJoinChannel=function(t){t.obj=t.content}},t.exports=n},function(t,e){"use strict";var n=11,i={wb:{id:n,initWhiteBoard:1,wbKeepCalling:2,wbCalleeAck:4,wbNotifyCalleeAck:5,wbHangup:8,wbNotifyHangup:9,wbControl:10,wbNotifyControl:11,wbNotifyRecord:12,wbCreateChannel:13,wbJoinChannel:14,wbNotifyJoin:15,wbQueryAccountUidMap:16}},o={initWhiteBoard:{sid:n,cid:i.wb.initWhiteBoard,params:[{type:"StrArray",name:"type"},{type:"StrArray",name:"accounts"},{type:"String",name:"pushContent"},{type:"String",name:"custom"},{type:"Property",name:"pushConfig"}]},wbKeepCalling:{sid:n,cid:i.wb.wbKeepCalling,params:[{type:"StrArray",name:"accounts"},{type:"long",name:"channelId"}]},wbCalleeAck:{sid:n,cid:i.wb.wbCalleeAck,params:[{type:"long",name:"channelId"},{type:"bool",name:"accepted"}]},wbHangup:{sid:n,cid:i.wb.wbHangup,params:[{type:"long",name:"channelId"}]},wbControl:{sid:n,cid:i.wb.wbControl,params:[{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"string",name:"info"}]},wbCreateChannel:{sid:n,cid:i.wb.wbCreateChannel,params:[{type:"String",name:"channelName"},{type:"String",name:"custom"},{type:"String",name:"webrtcEnable"}]},wbJoinChannel:{sid:n,cid:i.wb.wbJoinChannel,params:[{type:"String",name:"channelName"},{type:"Property",name:"liveOption"}]},wbQueryAccountUidMap:{sid:n,cid:i.wb.wbQueryAccountUidMap,params:[{type:"String",name:"channelName"},{type:"LongArray",name:"uids"}]}},r="datatun",s={"11_1":{service:r,cmd:"initWhiteBoard",response:[{type:"Number",name:"timetag"},{type:"Number",name:"uid"},{type:"Number",name:"channelId"},{type:"PropertyArray",name:"turnInfoTag"},{type:"StrArray",name:"keepCallingAccounts"},{type:"StrLongMap",name:"accountUidMap"},{type:"bool",name:"p2p"},{type:"String",name:"clientConfig"}]},"11_2":{service:r,cmd:"wbKeepCalling",response:[{type:"StrArr",name:"accounts"}]},"11_3":{service:r,cmd:"wbBeCalled",response:[{type:"Number",name:"timetag"},{type:"String",name:"account"},{type:"Number",name:"channelId"},{type:"PropertyArray",name:"turnInfoTag"},{type:"StrLongMap",name:"accountUidMap"},{type:"bool",name:"p2p"},{type:"String",name:"custom"},{type:"Number",name:"uid"},{type:"String",name:"clientConfig"},{type:"Property",name:"pushConfig"}]},"11_4":{service:r,cmd:"wbCalleeAck",response:[]},"11_5":{service:r,cmd:"wbNotifyCalleeAck",response:[{type:"long",name:"channelId"},{type:"String",name:"account"},{type:"bool",name:"accepted"}]},"11_6":{service:r,cmd:"wbNotifyCalleeAckSync",response:[{type:"String",name:"timetag"},{type:"long",name:"channelId"},{type:"byte",name:"type"},{type:"bool",name:"accepted"},{type:"byte",name:"fromClientType"}]},"11_7":{service:r,cmd:"xxxx",response:[]},"11_8":{service:r,cmd:"wbHangup",response:[]},"11_9":{service:r,cmd:"wbNotifyHangup",response:[{type:"long",name:"timetag"},{type:"long",name:"channelId"},{type:"String",name:"account"}]},"11_10":{service:r,cmd:"wbControl",response:[]},"11_11":{service:r,cmd:"wbNotifyControl",response:[{type:"String",name:"account"},{type:"byte",name:"type"},{type:"string",name:"info"},{type:"long",name:"channelId"}]},"11_12":{service:r,cmd:"wbNotifyRecord",response:[{type:"Property",name:"msg"}]},"11_13":{service:r,cmd:"wbCreateChannel",response:[{type:"long",name:"timetag"}]},"11_14":{service:r,cmd:"wbJoinChannel",response:[{type:"long",name:"timetag"},{type:"long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"},{type:"Property",name:"turnInfoTag"},{type:"String",name:"custom"}]},"11_15":{service:r,cmd:"wbNotifyJoin",response:[{type:"Long",name:"channelId"},{type:"StrLongMap",name:"accountUidMap"}]},"11_16":{service:r,cmd:"wbQueryAccountUidMap",response:[]}};t.exports={idMap:i,cmdConfig:o,packetConfig:s}},function(t,e){"use strict";t.exports={pushConfig:{enable:1,needBadge:2,needPushNick:3,pushContent:4,custom:5,pushPayload:6,sound:7,webrtcEnable:10},liveOption:{liveEnable:1,webrtcEnable:2},turnInfoTag:{channelId:0,tunnelServer:1,proxyServer:2,stunServer:3,type:4,dispatchServer:5}}},function(t,e){"use strict";t.exports={pushConfig:{1:"enable",2:"needBadge",3:"needPushNick",4:"pushContent",5:"custom",6:"pushPayload",7:"sound",10:"webrtcEnable"},liveOption:{1:"liveEnable",2:"webrtcEnable"},turnInfoTag:{0:"channelId",1:"tunnelServer",2:"proxyServer",3:"stunServer",4:"type",5:"dispatchServer"}}},,,,,,,,,,,function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(7),r=i(o),s=n(17),a=i(s),c=n(16),l=i(c),u=n(61),h=i(u),f=n(145),d=i(f),p=n(309),v=i(p),b=n(40),y=n(49),g=n(308),m=i(g);h["default"].CURRENT.SDK_TYPE=h["default"].SDK_TYPE.WHITEBOARD;var _=function(t){function e(n){(0,r["default"])(this,e);var i=(0,a["default"])(this,t.call(this,n));return i.initWB(),i}return(0,l["default"])(e,t),e.prototype.initWB=function(){if(!this.nim)throw new Error({error:"请传入nim实例"});this.initProtocol(),this.initController()},e.prototype.initProtocol=function(){var t=this.nim;t.on("wbBeCalled",this.onBeCalled.bind(this)),t.on("wbNotifyCalleeAck",this.onCalleeAck.bind(this)),t.on("wbNotifyHangup",this.onHangup.bind(this)),t.on("wbControl",this.onControl.bind(this)),t.on("wbNotifyCalleeAckSync",this.onCalleeAckSync.bind(this)),t.on("wbNotifyJoin",this.onNotifyJoin.bind(this))},e.prototype.initController=function(){var t=this;window.myWbContrl=this.controller=new v["default"]({appKey:this.nim&&this.nim.options.appKey,debug:this.debug,container:this.container,logger:this.logger,client:this,isCustom:this.isCustom}),this.controller.on("userJoined",this.onUserJoin.bind(this)),this.controller.on("signalClosed",function(e){t.emit("signalClosed",e)}),this.controller.on("willReconnect",function(e){t.emit("willReconnect",e)}),this.controller.on("disconnected",function(e){t.emit("disconnected",e)}),this.controller.on("connected",function(e){t.emit("connected",e)}),this.controller.on("leaveChannel",this.onUserLeft.bind(this)),this.controller.on("error",function(e){t.emit("error",e)}),this.controller.on("customData",function(e){t.emit("customData",e)}),this.controller.on("data",function(e){t.emit("data",{account:t.getAccountWithUid(e.uid),data:e.data})}),window.addEventListener("beforeunload",this.beforeunload.bind(this))},e.prototype.destroy=function(){var t=this;this.controller.destroy(),this.controller=null,this.nim=null,Object.keys(this).map(function(e){t[e]=null,delete t[e]})},e.prototype.serializeType=function(t,e){return e&&e!==y.constantBB.CALL_TYPE_NONE?e!==y.constantBB.CALL_TYPE_AUDIO?[t]:[e,t]:[t]},e.prototype.unserializeType=function(t){var e={},n=-1;return t.map(function(t,i){t===y.constantBB.CALL_TYPE_AUDIO&&(e.netcallType=y.constantBB.CALL_TYPE_AUDIO,n=i)}),n!==-1&&t.splice(e.i,1),e.type=t[0],e},e.prototype.call=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.account,n=t.type,i=t.netcallType,o=t.pushConfig,r=t.sessionConfig;return this.calling=!0,this.isCaller=!0,this.callee=e,this.target.account=e,r&&(r.signalStartTime=Date.now(),this.controller.setSessionConfig(r)),this.initWhiteBoard({type:n,netcallType:i,pushConfig:o})},e.prototype.initWhiteBoard=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.type,i=e.netcallType,o=e.pushConfig;this.type=n,this.netcallType=i||y.constantBB.CALL_TYPE_NONE,this.controller.setSessionConfig({signalStartTime:Date.now()});var r={type:this.serializeType(this.type,this.netcallType),accounts:[this.callee],pushConfig:o};return r.webrtcEnable=!0,this.nim.initWhiteBoard(r).then(function(e){t.signalInited=!0,t.sessionMode="p2p",t.logger.log("initWhiteBoard:",e),t.callerInfo=t.wbFormat(e),t.imInfo=t.callerInfo,t.imInfo.sessionMode=t.sessionMode,t.channelId=e.channelId,t.imInfo.role=0})["catch"](function(e){return t.controller.setSessionConfig({signalEndTime:Date.now()}),t.resetWhenHangup(),Promise.reject(e)})},e.prototype.response=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.fn="wbCalleeAck",this.baseResponse(t)},e.prototype.control=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.fn="wbControl",this.baseControl(t)},e.prototype.hangup=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.fn="wbHangup",t.recordType="cancelWhiteBoardBeforeAccept",this.baseHangup(t)},e.prototype.createChannel=function(t){return t.channelName?(t.custom=t.custom||"",this.baseCreateChannel("wbCreateChannel",t).then(function(t){return Promise.resolve(t)})["catch"](function(t){return Promise.reject(t)})):Promise.reject("缺少参数 channelName")},e.prototype.joinChannel=function(t){var e=this;if(this.signalInited)return Promise.reject("已经加入房间");if(!t.channelName)return Promise.reject("缺少参数 channelName");var n=t.sessionConfig;return n&&(b.tool.merge(this,{sessionConfig:n}),this.controller.setSessionConfig(n),this.controller.setSessionConfig({signalStartTime:Date.now()})),this.baseJoinChannel("wbJoinChannel",{channelName:t.channelName}).then(function(i){var o=void 0;return i.turnInfoTag&&(o=i.turnInfoTag.dispatchServer&&JSON.parse(i.turnInfoTag.dispatchServer)||i.turnInfoTag.tunnelServer),o&&o.constructor===String&&(o=o.split(";")),o&&o.constructor===Object&&(o=o.webrtcarray),i.serverAddrs=o||[],e.type=i.type=i.type,i.account=e.nim.account,i.sessionConfig=n,e.imInfo=i,e.imInfo.role=void 0===t.role?0:t.role,setTimeout(function(){e.sessionStarted||e.startSession(t)},200),Promise.resolve({uid:i.uid,account:e.nim.account,type:i.type})})["catch"](function(t){return Promise.reject(t)})},e.prototype.onBeCalled=function(t){t=this.wbFormat(t),this.channelId||(this.signalInited=!0,this.channelId=t.channelId,this.beCalledInfo=t,this.logger.log("beCalling",t)),this.emit("beCalling",t)},e.prototype.wbFormat=function(t){var e=t,n=e.turnInfoTag;return n&&n.constructor===Array?(n.map(function(e){/[01]/.test(e.type)?(t.netcallType=e.type,t.rtcServerMap=e.dispatchServer,t.serverMap=JSON.parse(JSON.stringify(e.dispatchServer))):(t.type=e.type,t.wbServerMap=e.dispatchServer)}),t.netcallType=t.netcallType||y.constantBB.CALL_TYPE_NONE,t=this.format(t),t.serverAddrs=JSON.parse(JSON.stringify(t.wbServerMap))||[],t):t},e.prototype.resetWhenHangup=function(){this.controller.stopSession(),this.resetStatus(),this.sessionStarted=!1},e}(d["default"]),w=_.prototype;w=Object.assign(w,m["default"]),e["default"]=_,t.exports=e["default"]},,function(t,e){"use strict";e.__esModule=!0,e["default"]=function(){return!!WebSocket},t.exports=e["default"]}])});